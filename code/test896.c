// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE 

#include <endian.h>
#include <fcntl.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/stat.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

static long syz_open_dev(volatile long a0, volatile long a1, volatile long a2)
{
	if (a0 == 0xc || a0 == 0xb) {
		char buf[128];
		sprintf(buf, "/dev/%s/%d:%d", a0 == 0xc ? "char" : "block", (uint8_t)a1, (uint8_t)a2);
		return open(buf, O_RDWR, 0);
	} else {
		char buf[1024];
		char* hash;
		strncpy(buf, (char*)a0, sizeof(buf) - 1);
		buf[sizeof(buf) - 1] = 0;
		while ((hash = strchr(buf, '#'))) {
			*hash = '0' + (char)(a1 % 10);
			a1 /= 10;
		}
		return open(buf, a2, 0);
	}
}

uint64_t r[1] = {0xffffffffffffffff};

int main(void)
{
		syscall(__NR_mmap, 0x1ffff000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x20000000ul, 0x1000000ul, 7ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x21000000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
				intptr_t res = 0;
memcpy((void*)0x20000000, "/dev/sg#\000", 9);
	res = -1;
res = syz_open_dev(0x20000000, 0, 0);
	if (res != -1)
		r[0] = res;
*(uint32_t*)0x20000300 = 0x200;
*(uint32_t*)0x20000304 = 0;
*(uint32_t*)0x20000308 = 8;
memcpy((void*)0x2000030c, "\x01\xa9\x12\xd1\xb3\x44\x8a\xdc\x09\xe2\x4c\xaf\xef\xc3\x6e\xde\x63\x35\x10\x3c\x2b\x92\x8d\xd3\x6a\x24\xcc\x6d\x71\xdb\x16\x03\x09\xc5\x97\x1b\x79\xb5\x33\x49\xab\xb2\x6c\xac\xc5\x41\xba\x18\xdc\xae\x3e\xe4\x91\x48\x85\x2b\x89\x85\x83\x2f\xe2\xd8\xb2\x6a\x19\xb1\x1a\x17\x98\xcb\x23\xc2\x8c\xd1\x4a\x2c\xe8\x33\x52\x9e\x3d\x02\x8a\xbf\xfd\x85\xb2\x40\x6c\xcc\xdc\xea\xeb\x98\x83\xad\x04\xcb\xaf\xf6\x5a\x76\xea\xfe\x2b\x51\x5b\xbd\x1b\xb8\xaf\x41\xbb\x81\x1a\x4a\x0d\xff\xe4\x78\x6b\x32\xc8\xfd\x1a\x1a\x0a\x86\xf7\xa8\xa9\xb8\x5f\xab\xfc\xad\x92\x5b\x04\x5c\x0a\xc7\xd4\x64\xef\x2b\x89\x34\xa4\x4e\xe7\x8b\x74\x0e\x12\xd1\x71\x21\x2f\x4f\x81\xe5\x6b\x8c\xf2\x9c\xec\xe2\xb9\x6f\x3f\x89\xba\xc3\x81\xfa\x54\xbe\x7e\x34\xd0\x70\x49\x02\xf1\x38\x57\x25\x82\xcc\x37\x86\x3b\x89\x10\xb0\xc2\x98\x26\x65\xe8\x14\x7d\x0f\xe9\xfa\xd9\xa5\x61\xb3\xc9\x7f\x47\x3b\x32\xa6\x51\x90\xba\xfc\xab\x50\x24\x4a\xd1\x02\x14\x0c\x88\xd9\x01\xc9\xf9\xf8\xd7\xe7\x9a\xa0\x9a\xb7\x4d\x15\xc6\x2a\xbe\x18\x8f\x78\x3b\x71\xf8\x08\xd3\xa2\x7d\x0f\x71\xa8\x5b\xcc\x7f\x9e\x05\xc4\x86\xf0\x3e\xc7\x8a\x29\x15\xd1\x66\xf2\xd2\xf7\x2a\x15\x24\xe9\xff\x15\x23\xf5\xa7\x5b\xab\xdf\x7a\x5f\x6f\xab\xb2\x2c\x10\x6b\xfc\x4e\x49\x5e\xd8\xa3\xde\xd0\xf5\xe8\x9f\xc5\xed\x74\x49\x00\x9d\x17\x26\x2b\x9a\x34\x54\x45\x44\x36\x66\x50\x0e\x73\x20\x8c\x94\x4a\x9c\x6f\xe9\x6f\xaf\x05\x5e\xcf\xee\x23\x79\x59\xa1\x91\x1e\xc6\xa0\xa4\x37\x68\xe0\xfc\x2a\xd6\xc0\x09\xa0\xca\x21\x16\x1d\x04\x62\x70\x64\x6e\x53\x35\x7e\xe4\x3f\xac\x4c\x3a\x97\x60\xec\xa8\x25\x7f\x0f\xdb\x52\x04\xeb\x33\x0f\xf3\x5a\x0e\xa4\x56\x06\x8f\x97\xca\x28\xae\x6b\xe2\xf0\x54\x87\x75\x7b\x36\xea\xa1\xed\x2b\x8f\x22\xa2\xd7\x9a\xf8\x55\xe5\x28\xcd\xa4\x4f\x3c\x7e\xa6\x76\x9e\xd8\xc7\xe6\x7b\x65\x25\x79\x92\x14\x99\x7b\xdb\x78\x9b\xe8\x5e\x42\x56\xbb\x55\x02\x57\x93\x13\x90\x07\x86\x7a\x39\x26\x32\xf4\x1f\xa6\xe0\x65\xab\xd0\x4a\x05\x92\x15\x22\x44\x83\xe9\x92\x20\xbe\xd0\xb5\xe3\x8f\x05\x23\xc9\x62\xf2\x30\x29\xe6\xbf\xe0\xd5\x6f\x87\xb9\x3f\x2f\x24\x70\x45\xff\x95\x12\xf0\x78\xb5\xaf\x58\x35\xd8\xa9\x15\xc3", 512);
	syscall(__NR_ioctl, r[0], 1, 0x20000300ul);
	return 0;
}
