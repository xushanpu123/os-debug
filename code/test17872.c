// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE 

#include <endian.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/mman.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

#ifndef __NR_io_uring_setup
#define __NR_io_uring_setup 425
#endif

#define BITMASK(bf_off,bf_len) (((1ull << (bf_len)) - 1) << (bf_off))
#define STORE_BY_BITMASK(type,htobe,addr,val,bf_off,bf_len) *(type*)(addr) = htobe((htobe(*(type*)(addr)) & ~BITMASK((bf_off), (bf_len))) | (((type)(val) << (bf_off)) & BITMASK((bf_off), (bf_len))))

#define SIZEOF_IO_URING_SQE 64
#define SIZEOF_IO_URING_CQE 16
#define SQ_HEAD_OFFSET 0
#define SQ_TAIL_OFFSET 64
#define SQ_RING_MASK_OFFSET 256
#define SQ_RING_ENTRIES_OFFSET 264
#define SQ_FLAGS_OFFSET 276
#define SQ_DROPPED_OFFSET 272
#define CQ_HEAD_OFFSET 128
#define CQ_TAIL_OFFSET 192
#define CQ_RING_MASK_OFFSET 260
#define CQ_RING_ENTRIES_OFFSET 268
#define CQ_RING_OVERFLOW_OFFSET 284
#define CQ_FLAGS_OFFSET 280
#define CQ_CQES_OFFSET 320

struct io_sqring_offsets {
	uint32_t head;
	uint32_t tail;
	uint32_t ring_mask;
	uint32_t ring_entries;
	uint32_t flags;
	uint32_t dropped;
	uint32_t array;
	uint32_t resv1;
	uint64_t resv2;
};

struct io_cqring_offsets {
	uint32_t head;
	uint32_t tail;
	uint32_t ring_mask;
	uint32_t ring_entries;
	uint32_t overflow;
	uint32_t cqes;
	uint64_t resv[2];
};

struct io_uring_params {
	uint32_t sq_entries;
	uint32_t cq_entries;
	uint32_t flags;
	uint32_t sq_thread_cpu;
	uint32_t sq_thread_idle;
	uint32_t features;
	uint32_t resv[4];
	struct io_sqring_offsets sq_off;
	struct io_cqring_offsets cq_off;
};

#define IORING_OFF_SQ_RING 0
#define IORING_OFF_SQES 0x10000000ULL

static long syz_io_uring_setup(volatile long a0, volatile long a1, volatile long a2, volatile long a3, volatile long a4, volatile long a5)
{
	uint32_t entries = (uint32_t)a0;
	struct io_uring_params* setup_params = (struct io_uring_params*)a1;
	void* vma1 = (void*)a2;
	void* vma2 = (void*)a3;
	void** ring_ptr_out = (void**)a4;
	void** sqes_ptr_out = (void**)a5;
	uint32_t fd_io_uring = syscall(__NR_io_uring_setup, entries, setup_params);
	uint32_t sq_ring_sz = setup_params->sq_off.array + setup_params->sq_entries * sizeof(uint32_t);
	uint32_t cq_ring_sz = setup_params->cq_off.cqes + setup_params->cq_entries * SIZEOF_IO_URING_CQE;
	uint32_t ring_sz = sq_ring_sz > cq_ring_sz ? sq_ring_sz : cq_ring_sz;
	*ring_ptr_out = mmap(vma1, ring_sz, PROT_READ | PROT_WRITE, MAP_SHARED | MAP_POPULATE | MAP_FIXED, fd_io_uring, IORING_OFF_SQ_RING);
	uint32_t sqes_sz = setup_params->sq_entries * SIZEOF_IO_URING_SQE;
	*sqes_ptr_out = mmap(vma2, sqes_sz, PROT_READ | PROT_WRITE, MAP_SHARED | MAP_POPULATE | MAP_FIXED, fd_io_uring, IORING_OFF_SQES);
	return fd_io_uring;
}

uint64_t r[1] = {0xffffffffffffffff};

int main(void)
{
		syscall(__NR_mmap, 0x1ffff000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x20000000ul, 0x1000000ul, 7ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x21000000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
				intptr_t res = 0;
*(uint32_t*)0x200002c4 = 0;
*(uint32_t*)0x200002c8 = 0;
*(uint32_t*)0x200002cc = 3;
*(uint32_t*)0x200002d0 = 0;
*(uint32_t*)0x200002d8 = -1;
memset((void*)0x200002dc, 0, 12);
syz_io_uring_setup(0, 0x200002c0, 0x20ffc000, 0x20ffc000, 0, 0);
memcpy((void*)0x20000440, "/dev/cdrom\000", 11);
	res = syscall(__NR_openat, 0xffffffffffffff9cul, 0x20000440ul, 0x40883ul, 0ul);
	if (res != -1)
		r[0] = res;
*(uint8_t*)0x20000480 = 2;
STORE_BY_BITMASK(uint32_t, , 0x20000480, 2, 8, 2);
memcpy((void*)0x20000482, "\xdd\xeb\x4b\xeb\xd3\xb7\x5a\x29\xb1\x74\x69\x46\x84\x2d\xd9\xd7\xe4\x9f\xdc\x05\xe7\xa9\x4f\x44\xf6\xaa\x02\x48\x29\x78\x6e\x19\x8c\xc3\x24\x51\xc2\x06\x32\x88\x76\xd1\x9d\x60\x4a\xc6\xca\x4b\x26\xff\x47\x19\xbc\xbc\x19\x11\x48\x04\xd6\x2b\x36\x75\x57\xc6\xbe\xe7\x66\xed\x77\x3b\x84\xa8\x76\xb5\x1a\x18\xba\x6c\x38\x5f\x56\xe9\x79\x75\x59\x2d\xb8\x5f\x01\x33\x8c\x10\xa8\x13\xbf\x74\xd4\x3e\xa5\xa3\x0c\x72\x22\x83\xc2\x1d\x80\xb9\x1b\xda\xea\x0c\x82\xf2\x85\xdf\xb2\xc9\xf7\xe1\xfe\x91\x38\xd1\xab\x19\x4e\x51\x90\x13\x2e\x78\xfb\x9b\xd8\xcd\xbb\xff\x5f\x45\xfa\x66\xc9\x20\x04\x83\xfe\xde\x29\x43\xe1\x01\xeb\x3c\x39\x8c\xa8\x5a\x8f\x16\xb8\x9e\xf7\x67\x39\x8f\x05\x8f\xde\xdd\xfa\xf4\x87\x28\xc0\x77\xb5\x1a\xed\x5c\xe8\x30\xb0\x39\xd4\xd1\x8e\xd3\x56\x82\x68\x68\x12\x51\x85\x38\xa3\xd5\xac\x60\xf2\x57\x1c\xe3\xae\xc9\xe1\xde\xcf\x21\x04\x9c\xe5\x1b\x8d\x07\xca\x36\xde\x57\x45\xaa\xe7\x01\xfc\xb2\x97\x55\x35\x33\x48\xf6\xb1\x9d\xd0\x5b\xd3\x9c\x9a\x9f\xab\xe1\x81\xe4\x2b\x28\xae\x98\x1f\xf9\x47\xbc\x3f\x36\xe8\x48\xb3\x5d\xab\x18\xb5\xd2\x98\x02\x49\xb6\x72\x54\x33\x90\x66\xa3\x02\x0f\x01\xa8\x98\xd1\x26\x4b\xaf\x8b\x06\x09\x92\x5d\xa3\xea\x53\xc2\x48\x4e\x68\x7f\x94\xe2\xb3\x4d\xf6\x38\x67\x9c\x40\xea\x3a\xa4\xa8\xb8\x99\xcc\x60\x96\x75\xa8\x05\x9d\x49\xee\x29\xcf\xba\xd4\xb1\x3c\x75\xf7\xe6\x10\x68\xe2\x25\xf7\x16\x3b\x84\xb4\x29\x98\xa3\x09\xbd\xe3\x83\x13\x7f\x9e\xd3\x26\xdb\x28\xbb\x9a\x6f\x8b\xa2\x57\xf7\xac\x5d\xe8\x20\x8b\x0c\xb3\x14\xd4\x87\x26\x3c\x11\x5e\x05\x61\xc3\x73\x41\xaa\x9d\x02\x8e\x03\xf6\x65\x42\x16\x4c\xd0\x6d\xde\x1a\x50\x20\x29\xc5\x3b\x1e\x57\x33\x6d\x6d\xd5\xda\xc1\x20\x28\x89\x43\x37\x5c\x06\x70\xaf\xab\x20\x39\xc4\xfc\x60\x91\xc7\xdf\xc8\x21\x7a\xdf\x81\x79\x1c\x11\xf3\xf5\x6b\x51\x32\xeb\x23\xbc\xef\xe7\x43\x22\xc0\x01\xd2\xa5\x66\x13\xf4\x67\xdd\x5d\x61\x59\x5a\x64\xb0\x19\x68\x02\x54\xd1\x7e\xe3\x48\x67\x33\xd2\xa3\x9d\xd3\x9c\x23\xf7\xaf\x11\x97\x1e\xa0\x34\xe9\xbc\xad\xbd\x07\x9b\xb5\xe5\x02\x7a\x36\xa4\x32\xb8\x97\xf3\x35\xec\xca\x88\xc9\xd4\x3a\x4f\xd1\x78\xf9\xc3\x3e\x1a\x03\xa0\x97\xbd\xee\x7b\x84\xf7\x5e\x80\xd7\x96\x89\x4f\x56\xbe\x67\x36\x17\x96\xf2\x10\x51\xa9\xbc\x3b\x71\x85\x41\x04\xb6\xfc\x28\x97\x5c\x41\x2b\xbc\xc9\x02\x43\x31\x4a\xc6\x7e\xd7\x68\x06\x34\xa4\x30\x46\xf0\x2a\x6b\x1e\xa6\x0b\xf8\xb0\x02\xf6\x29\xc4\xc2\x83\x22\x38\x99\x68\xf5\xe8\x7d\x0d\xd9\x8f\xc8\x67\x27\xe8\x5f\x01\xea\x98\x4e\xe9\x20\x04\x8b\x65\x51\xac\x4a\x83\x65\xa9\x05\xfc\x62\xa0\x74\x84\x77\xc0\x17\x0c\x35\x88\xe8\xe4\x57\x53\xb5\x00\x9f\x3a\x4b\x90\x8a\x01\x46\xf1\x54\x93\x23\xd4\x36\x2c\x82\xee\x13\xea\x60\x62\x20\x0b\x93\x4b\xea\x13\x47\xfd\x4d\x54\xce\x42\x8b\x41\x5d\x66\x8d\x29\xf7\x2b\x98\x24\xff\xf1\x71\x94\xae\xfa\x2b\x55\x3b\xc8\x39\x5b\xad\x31\xba\xec\x77\x1e\x2a\x1c\xe4\x7f\x8f\xad\x75\xd6\xea\xf4\x97\x28\x23\xad\x6c\x92\x21\x30\xd0\x67\xca\xa9\xf7\xd6\xf7\x96\xde\x72\xa9\x61\xa2\x7a\x1c\xad\x8f\x72\x95\xe7\xec\xbd\x10\x2b\x51\x3b\x62\x42\x51\x3a\xad\x6e\x1f\xcf\x74\x5b\x95\xac\xcd\x3f\x75\xa1\x57\x22\x56\xf5\x0c\xfe\xe7\xc1\x39\x6c\xbb\x8b\xe6\x4b\x7c\xb7\xd1\x3e\xb3\xc2\x4c\x8d\x48\xae\xab\xd4\xe4\x32\xc1\x58\xda\xc9\x2e\xaf\x73\xee\x4b\x66\xda\x7b\x55\xb2\xab\x4a\x64\xb5\xa8\x98\x55\xa8\x25\x5c\xa6\xd8\x26\xcf\x49\x68\x1b\x2a\xb3\x27\x56\x1c\x2d\xc9\xa1\x25\xb2\x80\xdd\x07\x67\x7e\x46\xc7\xa2\xe5\x8f\x4b\xfb\x81\xa4\xd5\x1c\x12\xed\x36\xa0\xe3\xdd\x45\x60\x9e\x66\x9d\xbd\x96\x80\x5e\xca\xc6\x5e\x61\x2f\x03\xba\x7d\x94\x1d\x97\x15\x2c\xd3\xd7\x84\xa6\x5d\xd0\xa7\xb4\x47\x44\x66\x9f\xf2\x9c\x8e\xae\x07\x1e\x9f\xb7\xf6\x0f\xa8\xff\x72\xa1\x1d\x1c\x48\xe6\x63\xbc\xc0\x8f\xf2\x77\xb5\xf7\x9f\x53\x61\x82\x9a\xf8\x0a\x95\x28\xa4\xa1\x89\x5c\x3c\xd2\x6c\x6c\x28\xb8\x92\x18\xfc\xed\x6b\x29\xc1\x92\x18\xe4\x47\x3b\x7d\x9e\xfd\x5f\xf3\x99\xdc\x85\x10\x08\x94\x7b\x4a\xf6\x07\xad\x19\x63\x24\xc4\xf9\x44\x85\x1c\xdf\xc0\xb0\x58\xc0\x9d\xfa\x53\xd7\x7f\xef\x1a\x50\xcd\xcd\x96\x51\x80\x49\xaf\xba\x20\xa6\xf6\xb7\xf6\xa3\xdb\x08\xfc\x37\xbb\x09\x20\x1c\x46\x64\x30\x7d\x13\x12\xd1\x88\xe2\xb7\x59\x9b\x2a\x7c\x71\x64\x28\x7e\x70\x91\xe1\xdc\x8d\xa4\x4e\x1d\xb5\xd4\x56\x82\xac\xfd\x5e\x92\x06\xa1\x2c\x37\xab\xbe\x9a\xfd\x82\x6b\xaf\x6d\xf6\x97\x53\xb8\xd0\xd3\x3f\x82\xb3\xff\xdd\xbf\x07\xee\xb1\x3f\x1d\xeb\xef\xb0\x45\x93\xb1\x7a\xcf\xe2\x33\x0f\x0d\xa4\xbe\x1a\x59\xb1\xbe\xaa\x79\x2e\x24\xbc\x6f\x36\x7d\x3b\xbe\xc8\x87\xc3\x79\x14\xdd\xdb\x39\x43\x53\xb4\xc7\xc3\x15\x3c\x4e\x62\x57\xcb\x92\xc5\x31\x25\xd7\x8e\xb4\x05\x23\x23\x6b\x6b\xa6\x1a\x9a\xee\x38\x15\xb7\x59\xbe\x78\xcd\x66\xf6\x1f\x1e\x7f\x3f\x75\xf3\x9e\x6e\xac\xb6\x22\x2e\x42\x0e\x94\xe8\x3e\xa7\x57\x96\x10\x5c\x2e\x0e\x13\xf0\x0b\xd5\x9c\xe0\x8d\x6c\xea\x2a\x2f\x6b\x1f\x60\x7a\x31\x29\x3a\x97\xf7\xf8\xac\x59\x28\xe5\x43\x8c\xed\xb8\x9f\x16\x8e\xd9\xa7\x98\xb2\x20\xfe\x56\x8f\xa4\xc1\x20\x88\x01\x79\xfb\x45\xb9\x89\xfa\x40\xcc\xa6\x3d\x68\x37\x4b\x49\x13\x9e\x67\xea\x61\xb4\xdf\xff\xaf\xa0\x0c\xa9\x7b\x03\x99\x49\x70\x05\x9d\x29\x14\x49\x98\x3c\x17\xf1\xaf\x53\x77\xb9\x3a\xaa\xda\xce\x13\x87\xa6\x13\x6c\x84\xf0\x4c\x28\xe4\xcb\xe0\x04\x3e\x29\x07\xca\x07\xf3\x33\x64\x44\xb1\x85\x4c\x55\x9e\x13\xe6\x49\x45\x83\x93\x56\x14\x95\x64\x19\xef\x04\x40\xdc\x08\xe3\xe0\x17\x56\x11\x82\x87\x3c\x99\x74\x7d\xbd\x22\x85\xac\xc6\x59\x34\x70\xe7\x77\x03\xd7\x90\xa4\x03\xe5\xd9\x00\xa4\xa7\x4c\x5d\xf6\xb3\xb7\x9e\xcd\x23\xe8\x7f\x8e\x69\xcd\xf3\x23\x24\x10\xb6\xce\xf0\x20\x39\xf5\xf9\x7d\x9b\x03\xf8\x58\xe8\x4e\xf3\x31\xca\xcc\x29\x08\xfd\x3d\x28\x1b\x9c\x6a\xd2\xe7\x37\x2a\x14\xee\x33\x7f\xa1\x22\x99\xdf\x0f\x9c\xd1\x79\xf4\x72\x64\xd6\x63\xb1\xf8\x08\x9d\x2c\xfe\xf4\x63\x1d\xe7\x88\xa5\xa4\x25\x53\x48\xbc\xa8\xcb\x69\xe3\xf4\x1e\x8b\xf4\x17\xd1\x13\xc9\x07\x69\xdd\xde\x51\x59\xd1\x0b\xbd\x66\x79\x5b\xd7\xb5\x15\xbe\x55\x7a\xe7\xf4\xea\x30\xf1\xd1\x50\xae\xab\x76\xb3\xce\x10\xb4\x0a\xe6\xe2\xfa\x0b\xc3\x89\xec\x8c\x1f\x3c\xd3\x25\x59\x05\x62\x79\x7e\x60\x85\x92\x5e\x3f\xb5\xa6\x98\x8f\x27\x18\x90\x0e\xa0\x9e\x9d\x4e\xf2\xaf\x7b\xb2\xe9\x05\x3a\xf6\x99\x69\xd3\x7f\xb7\xa6\xaf\xb5\xa8\xed\xa5\xb6\x65\xb9\xec\x00\xe5\xd4\xd8\x8a\xb3\xcd\xe8\x4f\xa6\xd9\x3b\xd5\xa3\xe5\x64\x3b\x2c\x48\x9c\xc9\xc0\xc3\xb9\x94\x0d\x83\x73\x1d\x3a\x16\x73\xf3\xc8\x86\x4c\x48\x8c\xed\x03\xea\x52\xfe\x06\x80\x25\xca\x93\x9b\xea\x90\xe0\x5b\x20\x9c\x1d\xa3\x00\xcc\xdc\x25\x9c\x73\xf0\x42\x38\x94\x59\x12\x77\x10\xfa\x04\x9b\xe0\xa9\x01\x3d\x7e\xc9\x83\x20\x40\x5e\x23\x8b\xd0\xb8\x9b\x4b\x28\x65\xf3\xeb\x72\xa8\xed\x40\x2f\xe3\xbe\xe7\xe0\x05\xf5\xac\xf2\x6e\x28\x8c\x4a\xb5\x66\x5e\xa5\x19\x73\x8a\x39\xc4\xdc\x98\x80\xe8\x82\xfe\x5e\x80\xea\x26\x7a\x2e\x71\x74\x14\x6e\xd6\xd3\x89\x31\x01\x0c\xd2\x06\xd6\xa6\xf0\x89\x49\xc7\xb2\xe7\x8a\x62\x8f\xb8\x10\x8c\xde\x3e\x12\x4f\x0c\x97\xce\x39\x56\x9f\x22\x2b\xef\xb8\xd9\x0d\xa1\x0f\x77\x3d\xb3\xc2\x4b\x41\xed\xc4\xd9\x14\x5b\x8c\x18\x9a\x93\x81\xe0\x8d\x39\xb3\xee\x59\x11\x0a\x41\xaa\x0a\x26\x7e\x54\x29\x1c\x41\x71\xa7\xd9\xa5\x9e\x69\x10\x0a\x06\x65\x76\x69\xa4\x86\x7b\x58\x52\x8b\x7e\x18\x7d\x30\xdf\x75\x80\xa3\x12\x9e\xb5\xa8\x44\x07\x3b\xde\x3b\xbe\x51\xae\x32\x86\x8c\x99\x07\x11\xc2\x45\x34\x49\x09\x8a\x75\xa8\x1b\x97\x33\x1c\x9f\xd3\x1c\x10\xd5\xc5\x34\x1d\x2a\x20\x6c\xd0\x83\x5f\x26\x10\x34\xea\x65\x29\x8e\x43\xfb\xf3\x15\xd3\xe0\x4f\xe9\xbe\x19\x48\x39\xcf\xa4\xfb\x1e\xb4\x11\xb9\xac\x52\x80\x8c\x15\x32\x2a\x6b\x21\x9e\x48\x19\x1e\x8d\xb4\xf5\x50\xca\x8f\x8f\xfb\x2c\x46\x99\xa7\x99\x15\x4c\x2a\x3a\x9c\x05\x8c\xd0\xd1\x71\x04\x27\x64\x71\xbe\xd6\x8b\x84\xd0\x50\x06\x6f\x97\x8d\xc4\x4f\x70\xb4\xb4\x84\x7c\x4f\x66\x8e\xfb\xb5\x79\x9c\x21\xa5\x74\x95\x44\x33\x36\xa4\x08\x93\x3b\xb4\xab\x1f\xa1\xca\xfc\xc2\xbe\x09\x77\xca\x15\xcc\xbf\x79\x97\x3f\x93\x80\xe6\xbc\x83\x9b\xf7\xeb\x93\xf9\xc0\x34\x2f\x07\xf9\x18\x79\x0f\xa9\x97\x7a\xa9\xd5\x63\x4a\x6c\x5a\x33\xe7\x59\x43\x6f\xae\x59\x01\x27\x92\xdd\x75\x65\xc1\x5c\x7a\xaf\xd9\xf9\xdf\xd8\x13\x03\x9b\x8c\x13\x40\xac\x1a\x33\x8f\xe1\xf5\xa4\xe1\x85\x94\x16\xd7\xbb\x9d\x7c\xf7\x0b\x9a\x25\x83\x26\xf9\x75\x29\xab\x49\x18\x33\x38\xb9\x12\xea\x9c\x4b\x09\x75\xcc\xc1\x02\x0e\x03\xa3\x68\x98\xea\x98\x3f\xdb\x30\x23\x3e\xd0\x79\x9b\x1d\x4b\x0c\xf6\x92\xd3\x34\x39\x1e\x0c\xf1\x04\xc6\xbb\x8c\x11\xd7\xe6\x6b\x13\xcf\x29\xbe\x90\x21\xbf\x9f\x33\xfe\x96\x7e\x28\x07\xd0\xc4\xee\x61\x84\x71\xaa\xd0\xf8\x30\x21\xda\x69\x42\x21\x1c\xf8", 2048);
	syscall(__NR_ioctl, r[0], 0x5390, 0x20000480ul);
	return 0;
}
