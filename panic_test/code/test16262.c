// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE 

#include <endian.h>
#include <sched.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

#include <linux/sched.h>

#ifndef __NR_clone3
#define __NR_clone3 435
#endif

#define USLEEP_FORKED_CHILD (3 * 50 *1000)

static long handle_clone_ret(long ret)
{
	if (ret != 0) {
		return ret;
	}
	usleep(USLEEP_FORKED_CHILD);
	syscall(__NR_exit, 0);
	while (1) {
	}
}

static long syz_clone(volatile long flags, volatile long stack, volatile long stack_len,
		      volatile long ptid, volatile long ctid, volatile long tls)
{
	long sp = (stack + stack_len) & ~15;
	long ret = (long)syscall(__NR_clone, flags & ~CLONE_VM, sp, ptid, ctid, tls);
	return handle_clone_ret(ret);
}

#define MAX_CLONE_ARGS_BYTES 256
static long syz_clone3(volatile long a0, volatile long a1)
{
	unsigned long copy_size = a1;
	if (copy_size < sizeof(uint64_t) || copy_size > MAX_CLONE_ARGS_BYTES)
		return -1;
	char clone_args[MAX_CLONE_ARGS_BYTES];
	memcpy(&clone_args, (void*)a0, copy_size);
	uint64_t* flags = (uint64_t*)&clone_args;
	*flags &= ~CLONE_VM;
	return handle_clone_ret((long)syscall(__NR_clone3, &clone_args, copy_size));
}

uint64_t r[2] = {0x0, 0x0};

int main(void)
{
		syscall(__NR_mmap, 0x1ffff000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x20000000ul, 0x1000000ul, 7ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x21000000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
				intptr_t res = 0;
*(uint64_t*)0x20000200 = 0;
*(uint64_t*)0x20000208 = 0;
*(uint64_t*)0x20000210 = 0;
*(uint64_t*)0x20000218 = 0;
*(uint32_t*)0x20000220 = 0;
*(uint64_t*)0x20000228 = 0;
*(uint64_t*)0x20000230 = 0;
*(uint64_t*)0x20000238 = 0;
*(uint64_t*)0x20000240 = 0;
*(uint64_t*)0x20000248 = 0;
*(uint32_t*)0x20000250 = -1;
	res = -1;
res = syz_clone3(0x20000200, 0x58);
	if (res != -1)
		r[0] = res;
	syscall(__NR_getpgid, r[0]);
memcpy((void*)0x20000280, "\x4e\xfe\x50\xa6\xe2\xa7\x74\xeb\x32\x6c\xd0\xdf\x09\xf0\xd5\x82\x22\x0a\xf7\x37\x19\x21\x2c\x75\xf1\x25\xc0\x60\xbe\xd8\x67\xa0\x7c\x4f\xf1\xed\x9a\xac\x50\xf3\x6c\x76\xe4\x94\x05\xc7\xc5\x35\x7f\xec\x74\xc9\xd9\x0b\x6d\xe6\x3f\xe1\xa5\x4a\x50\x71\x07\x31\x1a\x2f\x35\x44\xed\xad\x58\xaf\xc5\xe9\x31\xac\xbd\xbf\x5d\x0f\xd5\xd6\x96\xb7\x35\x99\x8a\x16\x27\xae\xff\x94\xdf\x0e\xbc\x1c\x5b\xf6\x55\x9a\x3e\x58\x06\x6d\x3d\x18\xe8\x93\x57\xe5\xfd\xd0\x82\x42\xfa\x56\x25\x79\x35\x60\x3a\xe2\x0c\x2b\x07\xe9\x07\x41\x8a\x4b\x3a\x05\xab\x12\xd3\x4a\xf0\x14\xa3\xa0\x9d\x24\xdd\x9d\x79\x45\x3a\x3c\xce\x73\x57\x63\x28\xd3\xc8\x2f\x78\x5b\x9d\xe9\xe1\x97\x35\x24\x8b\xb8\xb3\x1f\x0b\x01\xb2\x91\x70\x3f\x13\xaa\x07\x39\xdc\x44\x0a\xa0\x5e\x8b\x67\xb3\xd4\x1b\xf0\x14\xc5\xf5\xfb\xea\x3d\x82\xf2\x24\x4e\x89\x07\xe0\xa7\x87\xaf\xe2\x01\xaa\x29\x4e\x73\xba\x57\xa5\x62\xdf\xd5\xa6\x96\x27\xb6\xf7\x87\xb0\xf1\xc3\x58\x56\xcb\x50\x41\x09\xc3\xcc\x13\xf5\xec\x73\x56\x6b\x32\x2a\x04\xe3\x8c\xd2\xae", 247);
memcpy((void*)0x20000400, "\xd5\xf7\xcf\x96\xab\x6b\x44\xfb\x5f\x95\x47\xbe\xb3\xfb\xd9\x72\xd4\x61\x05\xef\xbb\xdd\x0b\x8e\xd3\xcd\x45\xbc\xfe\x66\x5a\x58\xd8\xc2\x2c\xb1\xb0\xd3\x92\x71\x58\x37\x42\xfe\xa5\x1f\x25\x58\x39\x99\xe2\xa9\xd5\xd7\xa1\xfe\x3f\x90\x35\x1a\xb5\x54\xc8\x89\xa7\x9c\xe9\x17\x6c\x84\x3d\x53\xff\x7d\x52\x3f\x93\x35\x8f\xc2\x44\x7c\xc7\x21\x10\x5c\x48\x78\xc2\xd5\x55\x29\x62\xf3\xe8\x84\xd9\x5a\x7c\x27\x94\xb0\x76\xc6\x18\x2d\x68\xe9\x2c\x54\xe7\xcd", 112);
syz_clone(0x80200, 0x20000280, 0xf7, 0x20000380, 0x200003c0, 0x20000400);
*(uint64_t*)0x20000700 = 0x60100000;
*(uint64_t*)0x20000708 = 0x20000480;
*(uint64_t*)0x20000710 = 0x200004c0;
*(uint64_t*)0x20000718 = 0x20000500;
*(uint32_t*)0x20000720 = 0x22;
*(uint64_t*)0x20000728 = 0x20000540;
*(uint64_t*)0x20000730 = 0xa2;
*(uint64_t*)0x20000738 = 0x20000600;
*(uint64_t*)0x20000740 = 0x200006c0;
*(uint32_t*)0x200006c0 = r[0];
*(uint32_t*)0x200006c4 = r[0];
*(uint32_t*)0x200006c8 = r[0];
*(uint32_t*)0x200006cc = r[0];
*(uint32_t*)0x200006d0 = 0;
*(uint32_t*)0x200006d4 = r[0];
*(uint32_t*)0x200006d8 = r[0];
*(uint32_t*)0x200006dc = r[0];
*(uint64_t*)0x20000748 = 8;
*(uint32_t*)0x20000750 = -1;
	res = -1;
res = syz_clone3(0x20000700, 0x58);
	if (res != -1)
r[1] = *(uint32_t*)0x20000500;
memcpy((void*)0x20000b40, "\x70\xc2\x02\x0d\x03\x6a\xc7\xab\x7b\xd7\xe7\x4a\x7c\x7d\x6b\x9a\x16\xcd\x9b\x77\xa8\x6a\xb1\xa0\x83\xd5\x77\x08\xab\x46\xc9\x69\xb7\xfd\x9d\x4e\x26\x54\x55\xb9\x64\x6d\xfd\x16\xd3\x81\xbe\x50\x47\x89\x16\xa1\x46\x0c\x8d\x8d\x51\xd5\x3b\xf0\x5b\xee\x85\x51\x89\x04\x68\x74\x7d\x97\xc1\x7a\xd0\x62\xee\x57\x04\x49\x58\xfb\x48\xbe\xb4\x88\x49\x89\x39\x7b\x9d\xef\xd6\x62\x03\xdc\x86\x4e\xb0\x7b\xf4\xc4\x19\x4f\x17\x12\xab\xf8\xc9\xb5\xba\x84\x6d\xe8\xdb\x53\xbc\xe0\xd8\x87\x83\xb0\x87\xca\xcd\xd0\xea\xad\xc7\xd4\xc5\x99\x9a\x9c\xa2\xd7\xee\x6d\xc8\x22\xc2\xbe\x8d\x9a\xbc\xc8\x79\xc8\x8d\x79\xfa\xe0\x53\x09\x9e\xa9\x02\x8c\x12\x58\xf3\x3a\x05\xdf\xeb\xdc\x4b\xd0\xf8\x36\x38\x32\x7b\x54\x20\x1f\x7c\x7e\x58\xde\xcd\xee\x43\x9b\x9a\xcb\xae\xb0\x01\xf4\x1d\xfc\x5f\x91\x3f\x11\xb7\x35\x31\x2d\x49\x95\xe1\x0b\x25\xb9\x08\x27\x97\x33\x7c\x69\xf5\x68\x5d\x6c\x10\x6e\x30\x25\x31\x11\x2b\xef\x5e\xa8", 224);
memcpy((void*)0x20000c40, "\x1f\x76\x85\x1e\x22\xf8\x3f\x1e\x11\x99\xf9\xdc\x1f\x29\x86\x48\x44\xb0\xfc\x4e\x32\x1a\x61\x1c\x2c\x18\x95\xa3\x1c\xdf\x96\x9b\x55\x1d\xba\x18\x2e\xd3\x61\x7c\x54\x46\xb9\x6d\x42\x70\x5d\x7e\xd8\x62\x97\x42\x26\x43\x2c\x45\xdb\x12\xb3\x58\xca\xc8\x75\xea\x7c\xcc\xb7\x90\x3f\xb2\x83\x96\x7e\x14\x0e\x26\xb6\x63\xf7\xa7\xfe\x17\x81\x6b\x14\x40\x8f\x88\x2b\xb8\x01\x4e\xec\xa9\x3c\xfa\x7f\xa6\x70\x37\x26\xad\xdc\xef\x9b\x7f\xba\x6b\x3e\x59\x30\xfd\x24\x33\xab\x91\x3d\xe6\x2c\xaa\x04\xc6\xab\x3b\xdb\xf3\x43\x4b\x8e\x06\x00\x9d\xae\x4c\x1f\xdb\xc6\xb2\xdc\x77\x13\x6f\xdd\x49\xf3\xaa\x94\x3a\x40\xa9\x3f\x7b\xd2\xb1\xd6\xd1\x08\xa8\xa4\xae\x06\x19\x80\x84\xd7\xa9\x6c\x65\x4e\x9c\x1f\xec\x47\xaa\xbb\x7a\x88\xa2\x88\x95\xe9\xa7\x1f\xa2\xc0\x09\x6f\x10\x1b\xd1\x35\x0d\x2b\x2e\xd0\xd7\xcf\x92\xaf", 199);
syz_clone(0x80202000, 0x20000b40, 0xe0, 0x20000180, 0x200001c0, 0x20000c40);
*(uint64_t*)0x20000a00 = 0xf6008000;
*(uint64_t*)0x20000a08 = 0x20000080;
*(uint64_t*)0x20000a10 = 0x20000880;
*(uint64_t*)0x20000a18 = 0x200008c0;
*(uint32_t*)0x20000a20 = 0x1b;
*(uint64_t*)0x20000a28 = 0x20000900;
*(uint64_t*)0x20000a30 = 0x64;
*(uint64_t*)0x20000a38 = 0x20000980;
*(uint64_t*)0x20000a40 = 0x200009c0;
*(uint32_t*)0x200009c0 = r[1];
*(uint32_t*)0x200009c4 = r[0];
*(uint64_t*)0x20000a48 = 2;
*(uint32_t*)0x20000a50 = -1;
syz_clone3(0x20000a00, 0x58);
	return 0;
}
