// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE 

#include <endian.h>
#include <fcntl.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/stat.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

static long syz_open_dev(volatile long a0, volatile long a1, volatile long a2)
{
	if (a0 == 0xc || a0 == 0xb) {
		char buf[128];
		sprintf(buf, "/dev/%s/%d:%d", a0 == 0xc ? "char" : "block", (uint8_t)a1, (uint8_t)a2);
		return open(buf, O_RDWR, 0);
	} else {
		char buf[1024];
		char* hash;
		strncpy(buf, (char*)a0, sizeof(buf) - 1);
		buf[sizeof(buf) - 1] = 0;
		while ((hash = strchr(buf, '#'))) {
			*hash = '0' + (char)(a1 % 10);
			a1 /= 10;
		}
		return open(buf, a2, 0);
	}
}

uint64_t r[1] = {0xffffffffffffffff};

int main(void)
{
		syscall(__NR_mmap, 0x1ffff000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x20000000ul, 0x1000000ul, 7ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x21000000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
				intptr_t res = 0;
memcpy((void*)0x20000040, "/dev/sg#\000", 9);
	res = -1;
res = syz_open_dev(0x20000040, 0, 0);
	if (res != -1)
		r[0] = res;
*(uint32_t*)0x20000080 = 0x240;
*(uint32_t*)0x20000084 = 0;
*(uint32_t*)0x20000088 = 0xa0;
memcpy((void*)0x2000008c, "\xde\xd5\x3b\x54\x00\x57\x8d\x96\x4b\x80\x31\x33\x2e\x16\x26\xeb\xc2\x02\x85\x3a\x4b\x3d\x9c\x53\xd2\x02\xcc\xef\x38\x28\x63\x19\x11\xf9\x4a\x3b\x0e\xd7\x07\x77\x1f\x8a\x0c\xfc\x3b\x3e\x5d\x40\xc6\x1c\xdb\xc4\x56\x53\x11\x54\xa7\x0f\x91\x0c\x43\x8c\xe9\xdb\xb9\xb0\xf4\xb3\xcc\x05\x55\x38\x15\x14\x66\x7c\x10\x0d\xfc\x13\xf1\xa6\xb5\x6a\x2f\xdc\x51\xc9\x7b\xd9\xf2\x98\x70\x75\x77\x77\x96\x1a\xb8\xe6\x29\x17\x1d\x36\x12\x26\x26\x63\xeb\xb1\x2d\xbb\xc9\xbd\xe7\xc8\x9c\x33\xa2\x6d\xc1\xdb\xbc\x8b\xbe\x76\x38\xd7\x5f\xe5\xd8\x5c\xa5\x51\x8c\x0b\x6c\xaf\xd5\x7a\xde\x2e\x1b\x98\x88\x78\xf1\x2d\x20\xa9\xe8\x8d\x5b\x12\xfa\x5b\x8d\x48\xaf\x36\x71\xb4\xb9\x8e\x19\xa1\x4f\xbe\xba\x84\xaa\x18\xb5\xaf\xe4\x01\x61\xa1\xa0\x9e\x99\xcc\x88\x69\x62\x40\xb9\x56\xd0\xba\xd0\x82\xe8\xde\xf3\xd2\x90\x85\x03\x5c\xcc\xb3\xc4\x4a\x16\x7d\x74\x8f\x6e\x68\x7a\xec\x23\xe1\xa0\xeb\x1a\x65\xcc\x1d\xab\x54\xa4\xf1\x56\x37\x12\x32\x30\xe3\x8c\x70\x4b\x06\xcd\xd8\x26\xa0\xce\x6a\x2b\x8e\x26\x62\xc4\x7a\x82\x47\x2f\xc4\xd8\x88\xe9\x8b\x63\x07\x4f\x3c\xec\x96\xb6\x43\x31\xb6\x1a\x6c\x94\x20\x01\x54\x8f\xf9\xaf\x7c\x79\xd1\x2b\xb2\x8d\xfe\x2a\xfd\x23\xb8\xfc\x40\x13\xb6\xdf\x2f\x6c\xfe\x90\x55\xd7\x76\xf1\x2d\xa5\xc5\xe7\x6a\xe1\xcd\x7f\xd2\x88\x66\x03\x88\xa3\x2f\xfd\x5c\xb1\x40\x97\x0d\x2a\x31\xf8\xf2\x93\x0a\x64\xfe\xfb\xb9\x4f\xf5\x05\xf6\x38\x64\x50\xcd\x51\xf7\xc4\x32\xf2\xf3\x32\x3b\xa6\x0a\xcb\x33\x0b\xdf\x0a\x85\x52\x45\xde\x77\xf3\xf8\xd7\x50\x76\x7c\x8e\xda\x2d\xe3\x00\x9f\x45\xa4\x66\x4f\x82\x19\x31\x95\x1a\xec\x9d\x3f\x4f\x8d\xf0\x0e\x46\xc2\xe3\x60\x74\x64\xc8\x2a\x69\x52\xbd\x00\x59\x74\x1a\x5b\x39\xf1\x6e\xa5\x2a\xfb\xce\xbd\x4d\x02\xad\x83\x6b\x17\xbe\x7c\xbf\x3e\xdb\xc7\x46\xc9\xb6\x90\x6b\x33\x83\xe1\x5c\x23\x04\x76\x1c\x87\xfd\xac\x90\x43\x71\xe5\xc8\xfb\x67\x51\xe4\xac\x15\xde\xd5\x87\xab\x97\xfe\xe7\x88\x67\x61\x72\x25\xf7\xd4\xbd\xd8\x16\x17\x21\x40\x1c\x7c\x0a\xdc\xb6\x98\xd4\x3c\x41\x32\x7e\x4a\xcb\x04\x4c\xc1\x0c\x0d\x1d\x76\xdc\x70\x65\x7b\x7a\xf3\x35\xa9\xf3\xc0\x92\x44\x05\x4d\x38\x67\x8f\x5d\x26\x4d\x0f\x99\x84\x51\xa8\x47\xbb\xf8\x52\x90\x95\x0a\xa2\xf7\x07\x1f\xaa\x0a\xd8\xcb\x23\x47\x78\x94\x61\xbd\x32\x74\xd7\x01\xa7\xd0\x5e\x45\xef\xc5\x10\x4c\xa5\xc2\x78\x86\xe5\x6c\x5d\xc7\xdd\xd8\x99\x93\x73\x4f\x4f\x37\x84\x3d\x15\x71\xd0\x0c\x6c\x81\xc7\xbf\xfa\xa2\xbd\x45\x26", 576);
	syscall(__NR_ioctl, r[0], 1, 0x20000080ul);
	return 0;
}
