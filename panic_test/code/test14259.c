// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE 

#include <endian.h>
#include <fcntl.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/stat.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

#define SIZEOF_IO_URING_SQE 64
#define SIZEOF_IO_URING_CQE 16
#define SQ_HEAD_OFFSET 0
#define SQ_TAIL_OFFSET 64
#define SQ_RING_MASK_OFFSET 256
#define SQ_RING_ENTRIES_OFFSET 264
#define SQ_FLAGS_OFFSET 276
#define SQ_DROPPED_OFFSET 272
#define CQ_HEAD_OFFSET 128
#define CQ_TAIL_OFFSET 192
#define CQ_RING_MASK_OFFSET 260
#define CQ_RING_ENTRIES_OFFSET 268
#define CQ_RING_OVERFLOW_OFFSET 284
#define CQ_FLAGS_OFFSET 280
#define CQ_CQES_OFFSET 320

static long syz_io_uring_submit(volatile long a0, volatile long a1, volatile long a2, volatile long a3)
{
	char* ring_ptr = (char*)a0;
	char* sqes_ptr = (char*)a1;
	char* sqe = (char*)a2;
	uint32_t sqes_index = (uint32_t)a3;
	uint32_t sq_ring_entries = *(uint32_t*)(ring_ptr + SQ_RING_ENTRIES_OFFSET);
	uint32_t cq_ring_entries = *(uint32_t*)(ring_ptr + CQ_RING_ENTRIES_OFFSET);
	uint32_t sq_array_off = (CQ_CQES_OFFSET + cq_ring_entries * SIZEOF_IO_URING_CQE + 63) & ~63;
	if (sq_ring_entries)
		sqes_index %= sq_ring_entries;
	char* sqe_dest = sqes_ptr + sqes_index * SIZEOF_IO_URING_SQE;
	memcpy(sqe_dest, sqe, SIZEOF_IO_URING_SQE);
	uint32_t sq_ring_mask = *(uint32_t*)(ring_ptr + SQ_RING_MASK_OFFSET);
	uint32_t* sq_tail_ptr = (uint32_t*)(ring_ptr + SQ_TAIL_OFFSET);
	uint32_t sq_tail = *sq_tail_ptr & sq_ring_mask;
	uint32_t sq_tail_next = *sq_tail_ptr + 1;
	uint32_t* sq_array = (uint32_t*)(ring_ptr + sq_array_off);
	*(sq_array + sq_tail) = sqes_index;
	__atomic_store_n(sq_tail_ptr, sq_tail_next, __ATOMIC_RELEASE);
	return 0;
}

static long syz_open_dev(volatile long a0, volatile long a1, volatile long a2)
{
	if (a0 == 0xc || a0 == 0xb) {
		char buf[128];
		sprintf(buf, "/dev/%s/%d:%d", a0 == 0xc ? "char" : "block", (uint8_t)a1, (uint8_t)a2);
		return open(buf, O_RDWR, 0);
	} else {
		char buf[1024];
		char* hash;
		strncpy(buf, (char*)a0, sizeof(buf) - 1);
		buf[sizeof(buf) - 1] = 0;
		while ((hash = strchr(buf, '#'))) {
			*hash = '0' + (char)(a1 % 10);
			a1 /= 10;
		}
		return open(buf, a2, 0);
	}
}

uint64_t r[1] = {0xffffffffffffffff};

int main(void)
{
		syscall(__NR_mmap, 0x1ffff000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x20000000ul, 0x1000000ul, 7ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x21000000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
				intptr_t res = 0;
	res = -1;
res = syz_open_dev(0xc, 4, 0x15);
	if (res != -1)
		r[0] = res;
*(uint8_t*)0x200018c0 = 0x1a;
*(uint8_t*)0x200018c1 = 0;
*(uint16_t*)0x200018c2 = 0;
*(uint32_t*)0x200018c4 = -1;
*(uint64_t*)0x200018c8 = 0;
*(uint64_t*)0x200018d0 = 0x200008c0;
memcpy((void*)0x200008c0, "\x72\xe9\x15\xc2\x09\x8f\x7c\xbd\xd2\xb5\xd8\x17\x07\x59\x81\x2a\x97\x40\xd7\x83\x9a\xe5\x88\x28\x7b\x4d\xf0\x27\xb5\x96\xae\xe9\x9a\xe8\xd8\x90\x07\xa1\x6f\x47\x27\x68\x8e\xad\x0d\xcb\xbd\x3e\xa9\x7f\xb8\x7a\x84\x37\x32\x78\xb4\xb8\x5e\x7e\xe5\xb7\x0c\x50\x05\xaa\xef\x57\xd1\x59\x51\xe6\x75\xcd\xe9\x77\x29\xc0\x85\xf3\xbb\x4c\xf6\xb6\x54\xac\x38\xd2\x3e\xec\x8e\xff\x8b\xc9\x5a\x71\xe2\x2d\xbd\x2a\xff\x90\x01\x90\xbc\xfe\xf7\x38\x61\x3b\xd3\xc4\xa9\x4f\xc7\x99\x7b\xd5\xbf\x41\x2d\x77\x7d\x80\x61\x60\xf4\x25\x93\x75\xb8\xa6\x48\x6e\xbf\xf4\x5c\x2a\x80\x7d\x10\x80\xd6\xb0\xc1\x30\x09\xc7\xe2\x79\xdf\x60\x16\xa1\x5c\x1f\x97\x95\x2b\x16\x8b\xa4\x5d\xef\x47\xaa\x9b\x32\xf4\x92\x10\x84\xb4\xb5\x3f\xf4\x1b\xad\x67\xae\xb5\x28\xc2\x3e\xe3\xb1\x5e\x20\xae\xce\x80\x57\x0d\x3a\x88\xe4\x03\xb2\x6d\xba\x45\x86\xa6\x6f\xa5\xf1\xb4\x4b\xb6\x19\x26\xae\x3d\xfe\xce\x07\xc9\x59\xdc\xd3\x15\xc7\x91\x98\x7c\x3e\x0d\xe9\x6e\x68\xb4\xf1\xa4\xef\xec\xb5\x99\xeb\xa3\x84\x31\x06\x02\x5b\xc0\xbb\xa0\xca\x8a\x36\xf2\x0a\xc9\x85\xa3\x4a\x7b\x1f\x9e\x41\x6f\xbd\xb9\xec\x2a\x62\x16\x1c\x09\x27\xa4\xb5\x6c\xc3\x3b\xc4\x4a\xe2\x37\x2d\x0c\xc3\x4c\x23\x1e\x25\x06\x29\xa3\xef\xc3\x9e\x4a\xa2\x95\xf6\xc1\x00\xa1\x2f\xf7\x3b\xb3\x83\xe2\xf0\xab\x7c\xbd\x96\x09\x47\x30\xe2\xd2\x55\xfe\xdf\x4f\x2e\x51\x21\x95\x67\x21\x05\xab\x56\xc0\x52\x86\x52\x05\xb9\x52\xa9\x42\xb9\x6a\x50\x3c\x4a\xb6\x51\x55\x9c\x34\x33\xb3\xcf\x05\x51\xc2\x25\xbf\x51\x28\x14\xcc\xa4\x6e\x70\x83\x32\x92\x06\xf6\xf0\xe1\xb9\x4d\xa3\xaf\x8f\x35\x94\x22\xdc\x19\xf0\x2e\xd5\xf7\xd2\x72\x03\xcf\x67\xa6\xe5\x38\xe8\x1b\x4e\xb4\xc9\x90\x5c\xf2\x82\x96\x8f\x90\xe1\xfe\xfe\xd7\xb4\x6c\x88\xf4\x12\xd8\x6f\x0e\xaf\x64\xb4\x4a\x9e\xca\xc9\x43\x54\xa3\x46\x13\xb4\x25\x1d\xaf\x4b\x3d\x69\xf4\xe8\x92\x25\xf5\xf6\xb7\xb8\xa7\x13\x08\xc3\xd0\xf5\x76\xdf\xaa\xee\x3b\x59\x89\x86\xb6\xc2\xda\x02\x13\x4a\xea\x5b\x36\x76\x5a\x48\x41\x7e\x49\xb1\x87\xaf\x58\xd8\xd9\x28\x77\xeb\xc9\x7a\xf1\xbe\x3b\xd7\xc1\x3b\xb3\x89\x60\x9b\x61\xf1\x2e\x61\x02\x83\x98\x62\xbb\x70\x3b\xcb\x3b\xd9\x20\x49\xbd\x08\x72\x03\xd4\xae\xb6\x53\x78\x82\x8d\x52\xae\x75\xf4\xc2\x8e\x31\x4e\x27\x51\xc8\xf7\xe1\x4d\x46\x5a\x92\x54\x8f\xeb\x1c\x33\xc6\xcd\x79\xd8\x82\x83\xbf\xf5\xe1\xdf\x8d\x15\x23\xa7\x3f\x87\x2b\x07\xb6\x18\xfe\x62\x4f\xae\x8c\x61\xd3\xb4\xaa\xc8\x80\x26\xf1\xb4\xa9\x1b\x62\xb9\x60\xc9\x0d\xcf\xf4\x28\x38\x98\x1b\x17\x99\x97\x9a\x49\x44\xb5\xc0\x7f\x1d\x46\x50\x0d\x41\x72\xb8\xee\xa0\xa6\xc4\x93\x57\x7b\x73\xdf\xb9\x07\x88\x06\x2e\xb3\x3b\x8d\x34\xfa\x9c\x91\x99\xa9\x59\x36\xb1\x3c\x47\xf1\x5f\x97\x38\xc9\x40\xef\x90\xd9\xb9\x4a\x55\x44\x1e\xd7\x5c\xfc\xb1\x89\x27\xbb\xec\x14\xa1\x51\x2a\x7d\x53\x9e\xd8\x5e\xed\xa0\x7a\xcd\x99\x81\x9c\xad\xf8\x2c\x85\xe6\x61\x3b\x50\xe5\x4c\x82\x55\xff\x1e\xd2\x5d\x63\xca\xfc\x5a\x6a\x9f\x4a\x03\x9b\x81\x40\x32\x46\x9f\x7d\x80\x8e\x91\x79\xfa\x94\xf3\x78\x93\xb6\xb2\xf5\xaf\xf0\x09\x4f\xdc\x87\x7a\x45\x3d\x79\x26\xc3\xfb\x9b\xb6\xfd\x33\x43\x3b\x62\x08\x6f\x7e\xd0\xee\x1d\xa3\xb7\x00\x73\xa6\xdb\x07\x2d\x68\x58\xaf\xd8\x39\x1c\xd3\x42\xd3\x37\x1a\x37\xd7\xdd\x10\xa9\xf7\x31\x8d\x07\xb9\x06\x5f\x72\xdf\x0d\x57\xa2\x2f\x5d\x4b\x5d\xd4\xff\xfc\xfd\x8d\xb0\x3c\x5c\x6b\x7b\x3a\xc0\x71\x03\x0c\x95\xa2\x90\x0e\x89\x5b\x62\xda\xac\xfb\x94\xbb\x00\xa0\x18\xfa\xfe\x91\x0e\xe8\x12\x83\x93\xff\x31\xc0\xbd\xc4\xe8\xa8\xe6\xf1\xf6\xbd\x06\x19\xc4\x84\xf4\x26\xe8\xd0\xb8\x62\x7d\x05\xc3\xa1\x60\x62\x6b\xc9\x76\xe6\xaf\x1e\xbd\x79\x1c\x6a\xd7\x59\x2a\x1a\x42\x61\xa0\xba\xe4\x12\xb9\xe7\x86\x24\x7e\x38\x09\x70\xb2\x23\x5d\x7c\xdf\x93\x56\x13\x88\xce\x1b\xc6\x56\x16\xe6\x14\x4b\x52\x51\xd2\x60\x94\x5e\x9d\x8c\x55\x37\xf3\xfc\xcc\xa8\xfd\x48\x92\x8e\x8f\x74\x7d\xc3\xd1\x81\x84\x35\x07\xeb\x4e\x66\x08\x3f\xce\x07\x87\x07\x0b\x1a\x65\xc3\xe7\x91\x9e\x59\x4a\x2f\x1e\x40\x27\xcd\xd3\x53\xd3\x45\xef\xb1\x97\xd5\x23\xac\xf1\xa1\x3a\xe8\xb7\x89\xb2\xed\xd8\xae\x25\xef\xbb\xac\x93\xb3\x17\xa7\x09\xf1\xc4\x64\xd8\xa5\x74\x71\x6f\x4b\xc6\x9d\x43\x83\xae\x27\xd9\x8e\x0f\x9f\x1f\xde\x47\xae\xfa\x7d\x14\xa4\x1f\x0b\xfc\xe3\xb6\x04\xb1\xfd\xd3\x98\x55\x8b\x06\x0d\x61\xd0\x1b\xa1\x8e\xb5\xdf\x2e\xd0\x19\x05\xd7\x66\x5f\x3c\xed\x66\x71\x0c\x9c\x7b\x6e\xdb\x1e\xf0\xc4\xce\x15\xe0\xd8\x44\x23\xfb\x47\x04\x05\x03\x4d\x5a\xe7\x05\x5f\x66\x98\xd0\xf1\x73\x6d\x5b\x2a\x98\xc5\x04\xc0\x76\x33\xde\x0e\xa9\xed\x7b\x69\xbf\xd1\xbc\x22\xee\x7a\xdd\x6c\x87\x4f\x70\xd2\xd8\xb9\x86\xd4\xdc\xfe\x85\xbd\x6c\x98\x7f\x00\x9b\x31\x47", 1098);
*(uint32_t*)0x200018d8 = 0x44a;
*(uint32_t*)0x200018dc = 0;
*(uint64_t*)0x200018e0 = 0;
*(uint16_t*)0x200018e8 = 0;
*(uint16_t*)0x200018ea = 0;
memset((void*)0x200018ec, 0, 20);
syz_io_uring_submit(0, 0, 0x200018c0, 0);
sprintf((char*)0x20000000, "0x%016llx", (long long)-1);
	syscall(__NR_write, r[0], 0x20000000ul, 0xffc9ul);
	return 0;
}
