// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE 

#include <endian.h>
#include <sched.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

#include <linux/sched.h>

#ifndef __NR_clone3
#define __NR_clone3 435
#endif

#define USLEEP_FORKED_CHILD (3 * 50 *1000)

static long handle_clone_ret(long ret)
{
	if (ret != 0) {
		return ret;
	}
	usleep(USLEEP_FORKED_CHILD);
	syscall(__NR_exit, 0);
	while (1) {
	}
}

#define MAX_CLONE_ARGS_BYTES 256
static long syz_clone3(volatile long a0, volatile long a1)
{
	unsigned long copy_size = a1;
	if (copy_size < sizeof(uint64_t) || copy_size > MAX_CLONE_ARGS_BYTES)
		return -1;
	char clone_args[MAX_CLONE_ARGS_BYTES];
	memcpy(&clone_args, (void*)a0, copy_size);
	uint64_t* flags = (uint64_t*)&clone_args;
	*flags &= ~CLONE_VM;
	return handle_clone_ret((long)syscall(__NR_clone3, &clone_args, copy_size));
}

int main(void)
{
		syscall(__NR_mmap, 0x1ffff000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x20000000ul, 0x1000000ul, 7ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x21000000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);

*(uint64_t*)0x20001380 = 0;
*(uint32_t*)0x20001388 = 0;
*(uint64_t*)0x20001390 = 0x20001340;
*(uint64_t*)0x20001340 = 0x20000100;
*(uint32_t*)0x20000100 = 0x184;
*(uint16_t*)0x20000104 = 0x14;
*(uint16_t*)0x20000106 = 0;
*(uint32_t*)0x20000108 = 0;
*(uint32_t*)0x2000010c = 0;
*(uint8_t*)0x20000110 = 0;
*(uint8_t*)0x20000111 = 0;
*(uint16_t*)0x20000112 = 9;
*(uint16_t*)0x20000114 = 1;
memcpy((void*)0x20000116, "\xcb\x7b\x4a\x50\xfc", 5);
*(uint16_t*)0x2000011e = 0x39;
*(uint16_t*)0x20000120 = 1;
memcpy((void*)0x20000122, "\xbb\x20\x2f\x5b\xcd\xe6\x60\x12\x3a\x76\x19\x1b\xd5\x26\xa9\xab\xf4\xc5\xd2\x4f\xf8\x00\xbd\x45\x7e\xf5\x79\x36\x1b\x00\xe3\xbe\xf4\x26\x71\x43\xc0\x32\xed\x8a\xa9\xcf\x44\x95\xff\xec\x92\xb3\x52\x47\x55\x3a\x85", 53);
*(uint16_t*)0x2000015a = 0xbd;
*(uint16_t*)0x2000015c = 1;
memcpy((void*)0x2000015e, "\xc7\xbf\xac\x90\x92\x09\xf3\xd9\x83\x6c\x97\xf9\x0c\x29\xdd\x0c\x04\x9c\x47\x6c\x9c\x5b\x17\xdb\x99\x24\xb1\x6d\x90\x8d\x70\x5d\x07\x24\xc9\xb4\x04\x04\x24\xf9\x84\x34\xfd\xfb\x57\x9a\x70\x2f\xf1\xab\xba\xaa\x97\x5c\x9b\xf5\xdc\x37\x02\xf5\xb9\x39\xe2\x50\x55\x93\x5f\x65\x9a\x62\x98\x14\xa8\x25\x4e\x06\xba\x76\x22\x1d\xe1\x58\x63\x3a\xfd\x62\xcc\xd0\x7b\xc8\xfe\xae\x80\x0b\x31\x82\x83\x7d\xee\x37\x16\xc1\x2c\x27\xb7\x2d\xeb\x49\xb6\x85\xf6\x15\x86\xad\xb3\xf8\x38\xda\x0a\x18\x3f\x52\x31\xcc\xf2\x8f\x76\xc5\x8d\xea\xfe\x57\x89\x50\x98\x98\xce\x76\xe7\xae\x39\xea\xa6\xe3\x12\xba\xe3\x8d\xda\x36\x45\xba\x82\x20\xf8\xda\x15\x37\x44\x70\x2e\x17\x9f\x98\xbf\x32\x0f\x5c\x38\xc1\x13\x41\x69\x2f\x21\xa8\xe6\x45\x4a\x08\x18\x27\x45\xbe\x17", 185);
*(uint16_t*)0x2000021a = 0x68;
*(uint16_t*)0x2000021c = 1;
memcpy((void*)0x2000021e, "\x39\xcf\xc5\x74\xd5\x53\x0c\xf3\xa0\xb5\x65\x3e\xed\x31\x32\xe8\xa5\x54\x7c\xb3\x41\x63\xb3\xb0\x2e\xe7\x1b\xd2\xd3\xc4\xf8\x0d\x2c\xea\xf2\xec\x66\xf3\xb1\x51\x90\xb1\x6a\xd5\x27\x02\xa0\xcc\x5c\xde\x23\x4d\x4d\x64\x6a\x85\x5c\x0f\x2a\x7b\x39\x38\x2d\xad\xfb\x9d\x5b\x53\x95\x58\x44\x09\x37\x50\x9e\x52\x2e\xf1\x1d\x28\xae\x25\xd7\x56\xea\xb6\xb8\xde\xbe\x9e\xf7\x11\x66\xa9\x5a\x10\x37\x6e\xde\xde", 100);
*(uint64_t*)0x20001348 = 0x184;
*(uint64_t*)0x20001398 = 1;
*(uint64_t*)0x200013a0 = 0;
*(uint64_t*)0x200013a8 = 0;
*(uint32_t*)0x200013b0 = 0;
	syscall(__NR_sendmsg, -1, 0x20001380ul, 0ul);
*(uint64_t*)0x20000000 = 0;
*(uint64_t*)0x20000008 = 0;
*(uint64_t*)0x20000010 = 0;
*(uint64_t*)0x20000018 = 0;
*(uint32_t*)0x20000020 = 0;
*(uint64_t*)0x20000028 = 0;
*(uint64_t*)0x20000030 = 0;
*(uint64_t*)0x20000038 = 0;
*(uint64_t*)0x20000040 = 0x20000280;
*(uint64_t*)0x20000048 = 1;
*(uint32_t*)0x20000050 = -1;
syz_clone3(0x20000000, 0x57);
	return 0;
}
