// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE 

#include <endian.h>
#include <fcntl.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/stat.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

#define BITMASK(bf_off,bf_len) (((1ull << (bf_len)) - 1) << (bf_off))
#define STORE_BY_BITMASK(type,htobe,addr,val,bf_off,bf_len) *(type*)(addr) = htobe((htobe(*(type*)(addr)) & ~BITMASK((bf_off), (bf_len))) | (((type)(val) << (bf_off)) & BITMASK((bf_off), (bf_len))))

static long syz_open_dev(volatile long a0, volatile long a1, volatile long a2)
{
	if (a0 == 0xc || a0 == 0xb) {
		char buf[128];
		sprintf(buf, "/dev/%s/%d:%d", a0 == 0xc ? "char" : "block", (uint8_t)a1, (uint8_t)a2);
		return open(buf, O_RDWR, 0);
	} else {
		char buf[1024];
		char* hash;
		strncpy(buf, (char*)a0, sizeof(buf) - 1);
		buf[sizeof(buf) - 1] = 0;
		while ((hash = strchr(buf, '#'))) {
			*hash = '0' + (char)(a1 % 10);
			a1 /= 10;
		}
		return open(buf, a2, 0);
	}
}

uint64_t r[11] = {0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0x0, 0x0, 0xffffffffffffffff, 0xffffffffffffffff};

int main(void)
{
		syscall(__NR_mmap, 0x1ffff000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x20000000ul, 0x1000000ul, 7ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x21000000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
				intptr_t res = 0;
*(uint32_t*)0x20000040 = 1;
*(uint32_t*)0x20000044 = 1;
*(uint32_t*)0x20000048 = 0x18;
*(uint32_t*)0x2000004c = -1;
*(uint32_t*)0x20000050 = 0x8000;
memcpy((void*)0x20000058, "./file0\000", 8);
	res = syscall(__NR_ioctl, -1, 0xc0189372, 0x20000040ul);
	if (res != -1)
r[0] = *(uint32_t*)0x2000004c;
	res = syscall(__NR_socket, 2ul, 3ul, 2);
	if (res != -1)
		r[1] = res;
	res = -1;
res = syz_open_dev(0xc, 4, 0x15);
	if (res != -1)
		r[2] = res;
*(uint16_t*)0x20000040 = 0;
*(uint16_t*)0x20000042 = 0;
*(uint16_t*)0x20000044 = 0;
*(uint16_t*)0x20000046 = 0xfff5;
*(uint8_t*)0x20000048 = 0;
memcpy((void*)0x20000049, "\x7b\xff\x7a\xec\xf5\x76\x9c\x00", 8);
	syscall(__NR_ioctl, r[2], 0x5408, 0x20000040ul);
	res = -1;
res = syz_open_dev(0xc, 4, 0x15);
	if (res != -1)
		r[3] = res;
*(uint8_t*)0x20002940 = 0x1a;
	syscall(__NR_ioctl, r[3], 0x5412, 0x20002940ul);
	res = syscall(__NR_socket, 0x11ul, 3ul, 0x300);
	if (res != -1)
		r[4] = res;
	res = syscall(__NR_socket, 2ul, 3ul, 2);
	if (res != -1)
		r[5] = res;
	res = syscall(__NR_socket, 0x11ul, 3ul, 0x300);
	if (res != -1)
		r[6] = res;
memcpy((void*)0x200002c0, "sit0\000\000\000\000\000\000\000\000\000\000\000\000", 16);
	res = syscall(__NR_ioctl, r[6], 0x8933, 0x200002c0ul);
	if (res != -1)
r[7] = *(uint32_t*)0x200002d0;
*(uint64_t*)0x20006840 = 0x20000240;
*(uint16_t*)0x20000240 = 2;
*(uint16_t*)0x20000242 = htobe16(0x4e22);
*(uint32_t*)0x20000244 = htobe32(0x64010100);
*(uint32_t*)0x20006848 = 0x10;
*(uint64_t*)0x20006850 = 0;
*(uint64_t*)0x20006858 = 0;
*(uint64_t*)0x20006860 = 0x200012c0;
*(uint64_t*)0x200012c0 = 0x1c;
*(uint32_t*)0x200012c8 = 0;
*(uint32_t*)0x200012cc = 8;
*(uint32_t*)0x200012d0 = r[7];
*(uint32_t*)0x200012d4 = htobe32(0x7f000001);
*(uint32_t*)0x200012d8 = htobe32(0);
*(uint64_t*)0x20006868 = 0x20;
*(uint32_t*)0x20006870 = 0;
*(uint32_t*)0x20006878 = 0;
	syscall(__NR_sendmmsg, r[5], 0x20006840ul, 1ul, 0ul);
*(uint16_t*)0x200000c0 = 1;
*(uint8_t*)0x200000c2 = 4;
*(uint8_t*)0x200000c3 = 1;
*(uint32_t*)0x200000c4 = 3;
*(uint8_t*)0x200000c8 = 0xac;
*(uint8_t*)0x200000c9 = 0x14;
*(uint8_t*)0x200000ca = 0x14;
*(uint8_t*)0x200000cb = 0xbb;
*(uint32_t*)0x200000cc = htobe32(-1);
	syscall(__NR_setsockopt, r[5], 0, 0xca, 0x200000c0ul, 0x10ul);
memcpy((void*)0x200002c0, "sit0\000\000\000\000\000\000\000\000\000\000\000\000", 16);
	res = syscall(__NR_ioctl, r[4], 0x8933, 0x200002c0ul);
	if (res != -1)
r[8] = *(uint32_t*)0x200002d0;
*(uint64_t*)0x20006840 = 0x20000240;
*(uint16_t*)0x20000240 = 2;
*(uint16_t*)0x20000242 = htobe16(0);
*(uint32_t*)0x20000244 = htobe32(0x64010100);
*(uint32_t*)0x20006848 = 0x10;
*(uint64_t*)0x20006850 = 0;
*(uint64_t*)0x20006858 = 0;
*(uint64_t*)0x20006860 = 0x200012c0;
*(uint64_t*)0x200012c0 = 0x1c;
*(uint32_t*)0x200012c8 = 0;
*(uint32_t*)0x200012cc = 8;
*(uint32_t*)0x200012d0 = r[8];
*(uint8_t*)0x200012d4 = 0xac;
*(uint8_t*)0x200012d5 = 0x14;
*(uint8_t*)0x200012d6 = 0x14;
*(uint8_t*)0x200012d7 = 0xbb;
*(uint32_t*)0x200012d8 = htobe32(0);
*(uint64_t*)0x20006868 = 0x20;
*(uint32_t*)0x20006870 = 0;
*(uint32_t*)0x20006878 = 0;
	syscall(__NR_sendmmsg, r[1], 0x20006840ul, 1ul, 0ul);
*(uint8_t*)0x20000080 = 0xfc;
*(uint8_t*)0x20000081 = 0;
memset((void*)0x20000082, 0, 13);
*(uint8_t*)0x2000008f = 0;
*(uint32_t*)0x20000090 = 0x57;
*(uint32_t*)0x20000094 = r[8];
	syscall(__NR_ioctl, r[0], 0x8918, 0x20000080ul);
	res = syscall(__NR_socket, 0x10ul, 3ul, 0);
	if (res != -1)
		r[9] = res;
*(uint64_t*)0x20006a00 = 0;
*(uint32_t*)0x20006a08 = 0;
*(uint64_t*)0x20006a10 = 0x200001c0;
*(uint64_t*)0x200001c0 = 0x20000200;
memcpy((void*)0x20000200, "\x14\x00\x00\x00\x26\x00\x01\xe7", 8);
*(uint64_t*)0x200001c8 = 0x14;
*(uint64_t*)0x20006a18 = 1;
*(uint64_t*)0x20006a20 = 0;
*(uint64_t*)0x20006a28 = 0;
*(uint32_t*)0x20006a30 = 0;
	syscall(__NR_sendmsg, r[9], 0x20006a00ul, 0ul);
memcpy((void*)0x20000000, "veth0_macvtap\000\000\000", 16);
memcpy((void*)0x20000010, "syz_tun\000\000\000\000\000\000\000\000\000", 16);
	syscall(__NR_ioctl, r[9], 0x8927, 0x20000000ul);
	res = syscall(__NR_socket, 0x11ul, 3ul, 0x300);
	if (res != -1)
		r[10] = res;
*(uint64_t*)0x200006c0 = 0x20000180;
*(uint16_t*)0x20000180 = 2;
*(uint16_t*)0x20000182 = htobe16(0x4e23);
*(uint32_t*)0x20000184 = htobe32(0x64010102);
*(uint32_t*)0x200006c8 = 0x10;
*(uint64_t*)0x200006d0 = 0x20000280;
*(uint64_t*)0x20000280 = 0x20000300;
memcpy((void*)0x20000300, "\x19\x3c\x21\xfd\xf2\xb5\x7d\x15\x6a\x2e\xa8\xd7\x9d\x50\xde\xe4\x22\xba\xba\x3b\xdb\xca\x9e\xa9\x2d\x7d\xd2\x86\x51\xc2\x35\x3a\x75\xc9\x14\x03\x3c\xdf\x96\x9e\x85\x12\x24\x81\x7b\xff\xcd\x68\x0e\x0a\x22\xb3\x8c\x3c\x16\x9a\x8b\xd0\x9a\x50\x02\x39\x89\x35\x1b\x90\xda\x21\x20\x0c\x09\x6b\x2e\x9e\x3e\x26\x90\x64\xeb\x0e\x57\xe2\x3b\xd7\x8d\xd4\xc4\x84\x68\xd7\x8b\x36\x14\x6c\x71\x09\x79\xf7\x73\x05\xc0\x3c\xd8\x5c\x8b\x9b\xd1\x91\xce\x92\x6c\xa1\x74\x3b\xe4\x37\xcf\x62\x1a\xcd\x4a\xac\x61\x68\x23\x32\x14\x03\x27\x9e\xa8\xed\x32\xef\x4b\xba\xe1\xae\xdb\xa1\xb1\x14\x6e\x2d\x8a\x8c\xb2\x4d\x1e\x39\x79\x0f\xb9\x37", 154);
*(uint64_t*)0x20000288 = 0x9a;
*(uint64_t*)0x20000290 = 0x200003c0;
memcpy((void*)0x200003c0, "\xde\xdf\xcb\xde\x25\xd9\x76\x5c\xc1\xba\xf7\x61\xdd\x2a\xfc\x1b\x4b\x98\x7d\xc1\xa5\x8f\xa7\x22\x8e\x2b\x0f\x61\x6f\xf7\xca\x55\xb8\x0a\x30\xd5\x4f\xe4\x02\xe6\x10\x8f\x11\xc2\xc1\xea\x60\xd0\x65\x11\xfe\xb1\xd1\x52\x00\x58\x7f\x06\x27\x9b\x6e\xd9\x38\x17\x04\xff\x5c\x61\x9c\xb6\x83\x69\x07\xcf\xa2\x62\x33\xae\xb1\xa9\x3a\x30\x56\x6c\xec\xd3\x2b\x8a\x30\x82\x02\x83\xe1\x48\xa4\x6e\x59\x3c\xe5\x92\x2e\xc1\x2f\x0c\x37\xb3\xd3\x0e\x98\x3d\xd3\xc5\xe2\xde\xde\xb5\xc9\x52\x02\x66\x23\xbe\xc0\xe1\x3d\x48\x2f\x18\x0b\x22\x30\xf2\xa6\xf4\xa8\x7e\x75\x39\xcd\x73\x8b\xa3\xa7\xb0\x51\x86", 146);
*(uint64_t*)0x20000298 = 0x92;
*(uint64_t*)0x200002a0 = 0x20000480;
memcpy((void*)0x20000480, "\xde\xf6\x4d\x35\x5c\xb1\x72\xfe\x71\x99\xcf\xdb\x2c\x09\xb1\x90\x8d\xdc\xc7\x73\xae\xc5\x48\x11\xe1\xb3\x5e\x97\xdf\x79\xfd\xca\xa5\x72\x6d\x6e\x91\xd5\x3e\x47\x40\xbc\xcb\xf9\xe1\x79\x8f\x12\x85\x36\x9c\x2d\x5e\x37\x09\x08\xff\xd6\x6f\xf9\xee\xd5\x67\x34\x4a\xe6\xe1\x03\x00\x9a\x9b\xf2\xa5\x00\x0f\x52\x86\x20\xe0\xeb\x10\x35\xf2\x31\x50\xfd\x40\x40\xd0\x1f\xcf\xd7\x10\x23\x62\x62\x45\x2b\xb2\xcc\xda\xf8\x20\xa1\xf8\x2e\x2d\x91\xe3\xc6\xdd\x6a\xa7\xd0\x90\x55\x33\xe9\x5e\xc4\xeb\xee\x1f\x71\xcf\x32\x88\x9e\x31\x56\x43\xea\x9f\xf5\x09\xaf\x4b\xba\x95\xac\xcb\x97\xbe\xb3\x1e\xdc\xda\xad\xbe\x93\x7e\x8b\x5d\x4e\xf9\x8a\x68\x6d\xb2\x21\x74\xab\x71\x1e\x73\x04\x91\x12\x65\x98\xc1\x54\x71\xab\x44\x77\x75\x9e\x7e\x5e\x32\xb8\xf0\xf2\x15\xf2\x63\x3c\x9a\xa5\x7f\x4d\x93\x54\x95\xa1\xbb\x29\xff\x50\x84\x3c\x6d\xf7\x99\xf8\x06\x37\x9a\x1d\xf9\x6b\xcb\x18\x16\x38\xa8\x57\x0e\x8d\x97\x67\x78\x7c\x93\x78", 226);
*(uint64_t*)0x200002a8 = 0xe2;
*(uint64_t*)0x200006d8 = 3;
*(uint64_t*)0x200006e0 = 0x20000580;
*(uint64_t*)0x20000580 = 0x6c;
*(uint32_t*)0x20000588 = 0;
*(uint32_t*)0x2000058c = 7;
*(uint8_t*)0x20000590 = 1;
*(uint8_t*)0x20000591 = 0x44;
*(uint8_t*)0x20000592 = 0xc;
*(uint8_t*)0x20000593 = 0x97;
STORE_BY_BITMASK(uint8_t, , 0x20000594, 3, 0, 4);
STORE_BY_BITMASK(uint8_t, , 0x20000594, 8, 4, 4);
*(uint32_t*)0x20000595 = htobe32(0xe0000001);
*(uint32_t*)0x20000599 = htobe32(0x7fffffff);
*(uint8_t*)0x2000059d = 7;
*(uint8_t*)0x2000059e = 0x17;
*(uint8_t*)0x2000059f = 0xd4;
*(uint8_t*)0x200005a0 = 0xac;
*(uint8_t*)0x200005a1 = 0x14;
*(uint8_t*)0x200005a2 = 0x14;
*(uint8_t*)0x200005a3 = 0xaa;
*(uint32_t*)0x200005a4 = htobe32(0x7f000001);
*(uint8_t*)0x200005a8 = 0xac;
*(uint8_t*)0x200005a9 = 0x14;
*(uint8_t*)0x200005aa = 0x14;
*(uint8_t*)0x200005ab = 0xbb;
*(uint32_t*)0x200005ac = htobe32(0xe0000002);
*(uint8_t*)0x200005b0 = 0xac;
*(uint8_t*)0x200005b1 = 0x14;
*(uint8_t*)0x200005b2 = 0x14;
*(uint8_t*)0x200005b3 = 0xbb;
*(uint8_t*)0x200005b4 = 1;
*(uint8_t*)0x200005b5 = 7;
*(uint8_t*)0x200005b6 = 0x1b;
*(uint8_t*)0x200005b7 = 0x68;
*(uint32_t*)0x200005b8 = htobe32(0xe0000002);
*(uint8_t*)0x200005bc = 0xac;
*(uint8_t*)0x200005bd = 0x1e;
*(uint8_t*)0x200005be = 0;
*(uint8_t*)0x200005bf = 1;
*(uint32_t*)0x200005c0 = htobe32(0x7f000001);
*(uint8_t*)0x200005c4 = 0xac;
*(uint8_t*)0x200005c5 = 0x14;
*(uint8_t*)0x200005c6 = 0x14;
*(uint8_t*)0x200005c7 = 0xbb;
*(uint32_t*)0x200005c8 = htobe32(0xe0000001);
*(uint8_t*)0x200005cc = 0xac;
*(uint8_t*)0x200005cd = 0x14;
*(uint8_t*)0x200005ce = 0x14;
*(uint8_t*)0x200005cf = 0xbb;
*(uint8_t*)0x200005d0 = 0x94;
*(uint8_t*)0x200005d1 = 4;
*(uint16_t*)0x200005d2 = 1;
*(uint8_t*)0x200005d4 = 0x44;
*(uint8_t*)0x200005d5 = 0xc;
*(uint8_t*)0x200005d6 = 0x3c;
STORE_BY_BITMASK(uint8_t, , 0x200005d7, 3, 0, 4);
STORE_BY_BITMASK(uint8_t, , 0x200005d7, 0xc, 4, 4);
*(uint32_t*)0x200005d8 = htobe32(0x64010102);
*(uint32_t*)0x200005dc = htobe32(5);
*(uint8_t*)0x200005e0 = 7;
*(uint8_t*)0x200005e1 = 0xb;
*(uint8_t*)0x200005e2 = 0x69;
*(uint32_t*)0x200005e3 = htobe32(0x7f000001);
*(uint32_t*)0x200005e7 = htobe32(0);
*(uint64_t*)0x200005f0 = 0x1c;
*(uint32_t*)0x200005f8 = 0;
*(uint32_t*)0x200005fc = 8;
*(uint32_t*)0x20000600 = r[7];
*(uint32_t*)0x20000604 = htobe32(0xa010101);
*(uint32_t*)0x20000608 = htobe32(0x64010101);
*(uint64_t*)0x20000610 = 0x2c;
*(uint32_t*)0x20000618 = 0;
*(uint32_t*)0x2000061c = 7;
*(uint8_t*)0x20000620 = 0x89;
*(uint8_t*)0x20000621 = 0x1b;
*(uint8_t*)0x20000622 = 0x68;
*(uint8_t*)0x20000623 = 0xac;
*(uint8_t*)0x20000624 = 0x1e;
*(uint8_t*)0x20000625 = 0;
*(uint8_t*)0x20000626 = 1;
*(uint8_t*)0x20000627 = 0xac;
*(uint8_t*)0x20000628 = 0x14;
*(uint8_t*)0x20000629 = 0x14;
*(uint8_t*)0x2000062a = 0xbb;
*(uint8_t*)0x2000062b = 0xac;
*(uint8_t*)0x2000062c = 0x14;
*(uint8_t*)0x2000062d = 0x14;
*(uint8_t*)0x2000062e = 0x12;
*(uint32_t*)0x2000062f = htobe32(0x64010101);
*(uint8_t*)0x20000633 = 0xac;
*(uint8_t*)0x20000634 = 0x14;
*(uint8_t*)0x20000635 = 0x14;
*(uint8_t*)0x20000636 = 0xaa;
*(uint8_t*)0x20000637 = 0xac;
*(uint8_t*)0x20000638 = 0x14;
*(uint8_t*)0x20000639 = 0x14;
*(uint8_t*)0x2000063a = 0xaa;
*(uint64_t*)0x20000640 = 0x14;
*(uint32_t*)0x20000648 = 0;
*(uint32_t*)0x2000064c = 1;
*(uint32_t*)0x20000650 = 0;
*(uint64_t*)0x20000658 = 0x14;
*(uint32_t*)0x20000660 = 0;
*(uint32_t*)0x20000664 = 2;
*(uint32_t*)0x20000668 = 7;
*(uint64_t*)0x20000670 = 0x11;
*(uint32_t*)0x20000678 = 0;
*(uint32_t*)0x2000067c = 1;
*(uint8_t*)0x20000680 = 2;
*(uint64_t*)0x200006e8 = 0x108;
*(uint32_t*)0x200006f0 = 0;
*(uint32_t*)0x200006f8 = 0;
	syscall(__NR_sendmmsg, r[10], 0x200006c0ul, 1ul, 0x40814ul);
	return 0;
}
