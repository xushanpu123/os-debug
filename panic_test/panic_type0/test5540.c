// autogenerated by syzkaller (https://github.com/google/syzkaller)

#define _GNU_SOURCE 

#include <endian.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/mman.h>
#include <sys/syscall.h>
#include <sys/types.h>
#include <unistd.h>

#ifndef __NR_epoll_pwait2
#define __NR_epoll_pwait2 441
#endif
#ifndef __NR_io_uring_register
#define __NR_io_uring_register 427
#endif
#ifndef __NR_io_uring_setup
#define __NR_io_uring_setup 425
#endif

#define SIZEOF_IO_URING_SQE 64
#define SIZEOF_IO_URING_CQE 16
#define SQ_HEAD_OFFSET 0
#define SQ_TAIL_OFFSET 64
#define SQ_RING_MASK_OFFSET 256
#define SQ_RING_ENTRIES_OFFSET 264
#define SQ_FLAGS_OFFSET 276
#define SQ_DROPPED_OFFSET 272
#define CQ_HEAD_OFFSET 128
#define CQ_TAIL_OFFSET 192
#define CQ_RING_MASK_OFFSET 260
#define CQ_RING_ENTRIES_OFFSET 268
#define CQ_RING_OVERFLOW_OFFSET 284
#define CQ_FLAGS_OFFSET 280
#define CQ_CQES_OFFSET 320

struct io_sqring_offsets {
	uint32_t head;
	uint32_t tail;
	uint32_t ring_mask;
	uint32_t ring_entries;
	uint32_t flags;
	uint32_t dropped;
	uint32_t array;
	uint32_t resv1;
	uint64_t resv2;
};

struct io_cqring_offsets {
	uint32_t head;
	uint32_t tail;
	uint32_t ring_mask;
	uint32_t ring_entries;
	uint32_t overflow;
	uint32_t cqes;
	uint64_t resv[2];
};

struct io_uring_params {
	uint32_t sq_entries;
	uint32_t cq_entries;
	uint32_t flags;
	uint32_t sq_thread_cpu;
	uint32_t sq_thread_idle;
	uint32_t features;
	uint32_t resv[4];
	struct io_sqring_offsets sq_off;
	struct io_cqring_offsets cq_off;
};

#define IORING_OFF_SQ_RING 0
#define IORING_OFF_SQES 0x10000000ULL

static long syz_io_uring_setup(volatile long a0, volatile long a1, volatile long a2, volatile long a3, volatile long a4, volatile long a5)
{
	uint32_t entries = (uint32_t)a0;
	struct io_uring_params* setup_params = (struct io_uring_params*)a1;
	void* vma1 = (void*)a2;
	void* vma2 = (void*)a3;
	void** ring_ptr_out = (void**)a4;
	void** sqes_ptr_out = (void**)a5;
	uint32_t fd_io_uring = syscall(__NR_io_uring_setup, entries, setup_params);
	uint32_t sq_ring_sz = setup_params->sq_off.array + setup_params->sq_entries * sizeof(uint32_t);
	uint32_t cq_ring_sz = setup_params->cq_off.cqes + setup_params->cq_entries * SIZEOF_IO_URING_CQE;
	uint32_t ring_sz = sq_ring_sz > cq_ring_sz ? sq_ring_sz : cq_ring_sz;
	*ring_ptr_out = mmap(vma1, ring_sz, PROT_READ | PROT_WRITE, MAP_SHARED | MAP_POPULATE | MAP_FIXED, fd_io_uring, IORING_OFF_SQ_RING);
	uint32_t sqes_sz = setup_params->sq_entries * SIZEOF_IO_URING_SQE;
	*sqes_ptr_out = mmap(vma2, sqes_sz, PROT_READ | PROT_WRITE, MAP_SHARED | MAP_POPULATE | MAP_FIXED, fd_io_uring, IORING_OFF_SQES);
	return fd_io_uring;
}

uint64_t r[11] = {0x0, 0xffffffffffffffff, 0x0, 0xffffffffffffffff, 0x0, 0xffffffffffffffff, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0xffffffffffffffff};

int main(void)
{
		syscall(__NR_mmap, 0x1ffff000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x20000000ul, 0x1000000ul, 7ul, 0x32ul, -1, 0ul);
	syscall(__NR_mmap, 0x21000000ul, 0x1000ul, 0ul, 0x32ul, -1, 0ul);
				intptr_t res = 0;
	res = syscall(__NR_io_setup, 5, 0x20000480ul);
	if (res != -1)
r[0] = *(uint64_t*)0x20000480;
memcpy((void*)0x200004c0, "/dev/loop-control\000", 18);
	res = syscall(__NR_openat, 0xffffffffffffff9cul, 0x200004c0ul, 0ul, 0ul);
	if (res != -1)
		r[1] = res;
	res = syscall(__NR_io_setup, 5, 0x20000000ul);
	if (res != -1)
r[2] = *(uint64_t*)0x20000000;
*(uint64_t*)0x20000100 = 0;
*(uint32_t*)0x20000108 = 0;
*(uint32_t*)0x2000010c = 0;
*(uint16_t*)0x20000110 = 0;
*(uint16_t*)0x20000112 = 0;
*(uint32_t*)0x20000114 = -1;
*(uint64_t*)0x20000118 = 0;
*(uint64_t*)0x20000120 = 0;
*(uint64_t*)0x20000128 = 0;
*(uint64_t*)0x20000130 = 0;
*(uint32_t*)0x20000138 = 0;
*(uint32_t*)0x2000013c = -1;
	syscall(__NR_io_cancel, r[2], 0x20000100ul, 0ul);
*(uint64_t*)0x20000580 = 0x20000140;
*(uint64_t*)0x20000140 = 0;
*(uint32_t*)0x20000148 = 0;
*(uint32_t*)0x2000014c = 0;
*(uint16_t*)0x20000150 = 7;
*(uint16_t*)0x20000152 = 8;
*(uint32_t*)0x20000154 = r[1];
*(uint64_t*)0x20000158 = 0x20000040;
memcpy((void*)0x20000040, "\x15\xa1\xac\x7b\x4a\x05\x19\xe3\x0d\xdb\xdf\x12\x9f\x31\x82\x67\x15\xf2\xe1\xf3\x62\xd5\xcd\x93\xe5\x7e\x33\x9a\x68\xdc\xb1\x55\x43\xcd\x68\xae\x4d\x6a\x45\x3f\xa9\xd5\x84\x90\x2d\xf2\x63\x76\xc6\xd9\xad\x37\x17\x76\x5b\xbb\x6d\x96\xa7\x11\x62\xe1\xee\x79\xcd\x52\x8e\xb6\x00\x66\xf7\xdb\x53\x7a\x3b\xe4\xc7\xc5\x58\xfe\x21\x8f\x56\x3a\x59\xcd\x71\xe1\xeb\xcd\xb7\x80\x6c\x09\xb8\xb6\x4f\xbd\xa1\x8d\x99\xea\x6c\xaf\xa6\x0a\x9e\x20\xd3\x90\xb2\xd1\x9a\x00\x0a\xb4\x1e\x72\x82\x27\x3d\xfc\xbe\x03\x8b\xd4\x1d\x39\x58\x6f\x4e\x0f\x51\x3a\x5e\x45\x85\xbb\xb0\x96\x46\x48\x3d\xca\x0d\x5e\xce\x6b\x66\x51\xb0\xb1\x3b\x82\x4a\xc8\x9a\x27\x10\xae\xdd\x39\x76\xdb\x44\xfb\x02\xe0\x8b\xac\x2f\x1b\x66\xc2\x1a\x10\x6e\x38\x44\xad\xdc\xf3\x53\x51\xfb\xdb\x9e\xc8\xbd\x98\xb6\xd4\x77\x5f\xdb\x76\xb9\xea\xbe\x94\xf4\x24\x93\x74\xfc", 205);
*(uint64_t*)0x20000160 = 0xcd;
*(uint64_t*)0x20000168 = 1;
*(uint64_t*)0x20000170 = 0;
*(uint32_t*)0x20000178 = 2;
*(uint32_t*)0x2000017c = -1;
*(uint64_t*)0x20000588 = 0x20000200;
*(uint64_t*)0x20000200 = 0;
*(uint32_t*)0x20000208 = 0;
*(uint32_t*)0x2000020c = 0;
*(uint16_t*)0x20000210 = 1;
*(uint16_t*)0x20000212 = 0x101;
*(uint32_t*)0x20000214 = r[1];
*(uint64_t*)0x20000218 = 0x20000640;
memcpy((void*)0x20000640, "\x9b\x88\xa4\x6c\x69\xf0\xb5\xad\xbf\xf3\xa0\xe9\x32\x3d\xcc\x7f\xac\xcb\xea\xb7\x3f\x39\x21\x26\x54\xe0\xd3\x9d\x93\xe8\x21\xbf\x1d\x97\x72\x7f\x9d\x55\x3e\x21\x2d\x25\x08\xe3\xee\xd6\xf2\x79\xe8\x89\x14\x14\x4b\x5b\x4a\x09\xe4\x79\x19\xcd\x02\xaa\xb7\x00\x9c\x36\x38\xa6\x77\xe3\xbd\x8e\x65\x91\x5f\xe5\x43\x16\x59\x1a\x20\x50\x71\x35\x20\x64\x55\x38\x77\x6c\x03\x60\x18\x48\xa8\xf2\xdf\xaa\x73\x05\x59\x12\xc1\xab\x1e\xbd\xe3\xf4\x04\x6f\x9a\xa1\xb1\xca\xef\x51\xc6\x60\xda\xd6\xe6\xfc\x02\x27\xe7\xae\x24\x9e\x63\xc9\x90\x95\x73\xe1\x36\x7b\xba\x44\x70\x1e\xee\x28\x16\x34\xa1\x6c\x61\x8c\x70\x35\xf5\x48\xd7\x52\x64\x5a\xc1\xe3\xfc\x20\x15\x43\x9d\x39\x34\xfc\x47\x26\xc7\xb6\x73\x3f\xa2\xff\x93\x79\xc7\x18\x0c\xf9\x07\xef\xf5\x61\xdd\xcf\xd0\x62\x34\xfc\x06\x0d\x7a\xe1\x1e\xf9\x9e\xd9\x2b\x18\xe1\xdb\x94\xf7\xe3\xbd\x9c\xe0\x32\x81\xff\xe8\xe7\xb8\x58\x01\xa2\x75\x01\xa3\x24\x5c\x63\x5d\x20\x00\x00\x00\x00\x72\xd3\xee\xfb\xd9\xd3\x05\x53\x7f\xd8\x65\xd0\x7f\x22\x95\xc4\x3a\x54\x94\x15\x1e\xb4\x31\x6e\xe9\xee\x58\x21\x58\xc1\x1f\x96\x7a\x04\x7a\x2f\xfa\x9e\xbd\xd5\x58\x23\xf9\x0c\x32\x19\x40\xb0\x9d\xac\xef\xf8\x6b\x16\x14\x90\xac\xe0\x73\x5a\x78\x78\x77\x55\xce\xf9\x84\xa4\xdc\x4d\x75\x6c\x3f\x05\xaf\xdf\xbb\x5e\x81\x71\xa8\x06\x11\x75\x29\x91\x96\x48\x69\xe5\x90\x67\xb5\xdc\x18\x20\x14\xb8\xdd\xf9\x81\x5c\xb9\xec\x87\xe0\xdd\xfe\x48\x11\xd7\x5a\xf3\x90\x1a\xad\x1b\xf2\x72\x7a\xb3\xc9\xc0\xe2\x28\x17\xa8\xa6\x29\x4e\xfa\x55\xd6\x07\xbd\xee\xca\x82\x79", 368);
*(uint64_t*)0x20000220 = 0x170;
*(uint64_t*)0x20000228 = 4;
*(uint64_t*)0x20000230 = 0;
*(uint32_t*)0x20000238 = 2;
*(uint32_t*)0x2000023c = -1;
*(uint64_t*)0x20000590 = 0x20000280;
*(uint64_t*)0x20000280 = 0;
*(uint32_t*)0x20000288 = 0;
*(uint32_t*)0x2000028c = 0;
*(uint16_t*)0x20000290 = 7;
*(uint16_t*)0x20000292 = 7;
*(uint32_t*)0x20000294 = -1;
*(uint64_t*)0x20000298 = 0x20000240;
memcpy((void*)0x20000240, "\x51\x66\x6d\x1c\x3c", 5);
*(uint64_t*)0x200002a0 = 5;
*(uint64_t*)0x200002a8 = 2;
*(uint64_t*)0x200002b0 = 0;
*(uint32_t*)0x200002b8 = 3;
*(uint32_t*)0x200002bc = -1;
*(uint64_t*)0x20000598 = 0x20000380;
*(uint64_t*)0x20000380 = 0;
*(uint32_t*)0x20000388 = 0;
*(uint32_t*)0x2000038c = 0;
*(uint16_t*)0x20000390 = 0;
*(uint16_t*)0x20000392 = 6;
*(uint32_t*)0x20000394 = -1;
*(uint64_t*)0x20000398 = 0x200002c0;
memcpy((void*)0x200002c0, "\xc8\xca\x6b\x27\x04\x4f\x5d\xa2\x38\x9b\x96\xa5\xf8\x46\x6b\x0f\xcd\x94\x90\x97\xe1\x77\x51\x89\x9b\x87\xb7\x7d\x6b\x36\x18\xde\x55\x6f\x5e\x1f\xd4\x94\x5e\x29\x43\xc3\x30\xfb\xf9\x70\x7b\xd6\xf6\xde\x79\x38\xfb\x2a\x91\x1c\x88\x6e\x54\x6a\x9c\xaf\x36\xfe\x97\xa7\xd2\x8e\xe7\xd0\x95\xc0\x46\xe0\xab\x4c\x4a\x1f\xc5\xb6\xa7\xeb\x2b\x1c\x19\xec\xa1\x52\x0f\x49\x5b\x00\x3c\x49\x5a\xd3\x47\x83\xf2\xfc\x3e\x36\x55\x31\x13\x05\x66\xe5\xa9\x8f\xd2\x4e\x1e\xe9\xfd\x32\xd7\x4b\xda\xe9\xaf\x45\xb8\x9d\x78\xa7\xb9\x01\xd0\xcb\xf9\x0f\x18\x0b\x14\x8b\x48\x13\xba\xc3\x37\x22\x60\xee\x9f\xf4\x9a\x97\xe0\x3c\xab\xc7\x69\x28\xe5\xbc\x26\x2e\x08\x38", 160);
*(uint64_t*)0x200003a0 = 0xa0;
*(uint64_t*)0x200003a8 = 5;
*(uint64_t*)0x200003b0 = 0;
*(uint32_t*)0x200003b8 = 2;
*(uint32_t*)0x200003bc = -1;
	syscall(__NR_io_submit, r[2], 4ul, 0x20000580ul);
memcpy((void*)0x200003c0, "/dev/vcs\000", 9);
	res = syscall(__NR_openat, 0xffffffffffffff9cul, 0x200003c0ul, 0ul, 0ul);
	if (res != -1)
		r[3] = res;
	res = syscall(__NR_ioctl, r[1], 0x4c80, 0xaul);
	if (res != -1)
		r[4] = res;
	syscall(__NR_ioctl, r[1], 0x4c81, r[4]);
memcpy((void*)0x200003c0, "/dev/vcs\000", 9);
	res = syscall(__NR_openat, 0xffffffffffffff9cul, 0x200003c0ul, 0ul, 0ul);
	if (res != -1)
		r[5] = res;
	res = syscall(__NR_clock_gettime, 0ul, 0x20000e00ul);
	if (res != -1)
r[6] = *(uint64_t*)0x20000e08;
*(uint64_t*)0x20000e40 = 0;
*(uint64_t*)0x20000e48 = r[6]+60000000;
*(uint64_t*)0x20000e80 = 6;
	syscall(__NR_epoll_pwait2, r[5], 0x20000dc0ul, 1ul, 0x20000e40ul, 0x20000e80ul, 8ul);
*(uint32_t*)0x20000000 = r[5];
	syscall(__NR_io_uring_register, r[3], 7ul, 0x20000000ul, 1ul);
memcpy((void*)0x200003c0, "/dev/vcs\000", 9);
	res = syscall(__NR_openat, 0xffffffffffffff9cul, 0x200003c0ul, 0ul, 0ul);
	if (res != -1)
		r[7] = res;
	syscall(__NR_clock_gettime, 0ul, 0x20000e00ul);
	res = syscall(__NR_clock_gettime, 0ul, 0x20000440ul);
	if (res != -1) {
r[8] = *(uint64_t*)0x20000440;
r[9] = *(uint64_t*)0x20000448;
	}
*(uint64_t*)0x20000e40 = r[8];
*(uint64_t*)0x20000e48 = r[9]+60000000;
*(uint64_t*)0x20000e80 = 0x40006;
	syscall(__NR_epoll_pwait2, r[7], 0x20000500ul, 1ul, 0x20000e40ul, 0x20000e80ul, 0xfffffffffffffecful);
	syscall(__NR_ioctl, r[7], 0x4c06, r[3]);
*(uint64_t*)0x20000600 = 0x20000540;
*(uint64_t*)0x20000540 = 0;
*(uint32_t*)0x20000548 = 0;
*(uint32_t*)0x2000054c = 0;
*(uint16_t*)0x20000550 = 0;
*(uint16_t*)0x20000552 = 0;
*(uint32_t*)0x20000554 = r[1];
*(uint64_t*)0x20000558 = 0;
*(uint64_t*)0x20000560 = 0;
*(uint64_t*)0x20000568 = 0;
*(uint64_t*)0x20000570 = 0;
*(uint32_t*)0x20000578 = 1;
*(uint32_t*)0x2000057c = r[3];
	syscall(__NR_io_submit, r[0], 1ul, 0x20000600ul);
*(uint32_t*)0x20000184 = 0x6d9e;
*(uint32_t*)0x20000188 = 2;
*(uint32_t*)0x2000018c = 0;
*(uint32_t*)0x20000190 = 0x7b;
*(uint32_t*)0x20000198 = r[3];
memset((void*)0x2000019c, 0, 12);
	res = -1;
res = syz_io_uring_setup(0x74a1, 0x20000180, 0x20ffc000, 0x20ffc000, 0x20000400, 0x200005c0);
	if (res != -1)
		r[10] = res;
	syscall(__NR_io_uring_register, r[10], 9ul, 0ul, 0ul);
	return 0;
}
